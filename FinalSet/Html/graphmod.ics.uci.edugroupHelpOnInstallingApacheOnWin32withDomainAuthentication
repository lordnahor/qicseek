<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="robots" content="index,nofollow">

<title>HelpOnInstalling/ApacheOnWin32withDomainAuthentication - GraphModAlg@UCI</title>
<script type="text/javascript" src="/moin_static163/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static163/rightsidebar/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="/moin_static163/rightsidebar/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="/moin_static163/rightsidebar/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="/moin_static163/rightsidebar/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static163/rightsidebar/css/msie.css">
<![endif]-->


<link rel="alternate" title="GraphModAlg@UCI: HelpOnInstalling/ApacheOnWin32withDomainAuthentication" href="/group/action/rss_rc/HelpOnInstalling/ApacheOnWin32withDomainAuthentication?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=HelpOnInstalling%2FApacheOnWin32withDomainAuthentication&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="/group/Main_Page">
<link rel="Alternate" title="Wiki Markup" href="/group/HelpOnInstalling/ApacheOnWin32withDomainAuthentication?action=raw">
<link rel="Alternate" media="print" title="Print View" href="/group/HelpOnInstalling/ApacheOnWin32withDomainAuthentication?action=print">
<link rel="Up" href="/group/HelpOnInstalling">
<link rel="Search" href="/group/FindPage">
<link rel="Index" href="/group/TitleIndex">
<link rel="Glossary" href="/group/WordIndex">
<link rel="Help" href="/group/HelpOnFormatting">
</head>

<body  lang="en" dir="ltr">

<div id="header">

<form id="searchform" method="get" action="/group/HelpOnInstalling/ApacheOnWin32withDomainAuthentication">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<div id="logo"><a href="/group/Main_Page"><img src="/moin_static163/common/moinmoin.png" alt="MoinMoin Logo"></a></div>
<div id="locationline">


<ul id="pagelocation">
<li><a href="/group/HelpOnInstalling">HelpOnInstalling</a></li><li><a class="backlink" href="/group/action/fullsearch/HelpOnInstalling/ApacheOnWin32withDomainAuthentication?action=fullsearch&amp;context=180&amp;value=linkto%3A%22HelpOnInstalling%2FApacheOnWin32withDomainAuthentication%22" rel="nofollow" title="Click to do a full-text search for this title">ApacheOnWin32withDomainAuthentication</a></li>
</ul>

</div>

</div>

<div id="sidebar">
<div class="sidepanel">
<h1>Wiki</h1>

<ul id="navibar">
<li class="wikilink"><a href="/group/Main_Page">Main_Page</a></li><li class="wikilink"><a href="/group/RecentChanges">RecentChanges</a></li><li class="wikilink"><a href="/group/FindPage">FindPage</a></li><li class="wikilink"><a href="/group/HelpContents">HelpContents</a></li><li class="current"><a href="/group/HelpOnInstalling/ApacheOnWin32withDomainAuthentication">ApacheOnWin...hentication</a></li>
</ul>

</div>
<div class="sidepanel">
<h1>Page</h1>
<ul class="editbar"><li><span class="disabled">Immutable Page</span></li><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbinfo" href="/group/action/info/HelpOnInstalling/ApacheOnWin32withDomainAuthentication?action=info" rel="nofollow">Info</a></li><li><a class="nbattachments" href="/group/action/AttachFile/HelpOnInstalling/ApacheOnWin32withDomainAuthentication?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="/group/HelpOnInstalling/ApacheOnWin32withDomainAuthentication">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="raw">Raw Text</option>
<option value="print">Print View</option>
<option value="RenderAsDocbook">Render as Docbook</option>
<option value="refresh">Delete Cache</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="SpellCheck">Check Spelling</option>
<option value="LikePages">Like Pages</option>
<option value="LocalSiteMap">Local Site Map</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
<option value="PackagePages">Package Pages</option>
<option value="SyncPages">Sync Pages</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="Load">Load</option>
<option value="Save">Save</option>
<option value="SlideShow">SlideShow</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>
<div class="sidepanel">
<h1>User</h1>
<ul id="username"><li><a href="/group/action/login/HelpOnInstalling/ApacheOnWin32withDomainAuthentication?action=login" id="login" rel="nofollow">Login</a></li></ul>
</div>
</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><span class="anchor" id="line-8"></span><p class="line867">
<h1 id="Authenticating_against_Windows-Domain_using_SSPI">Authenticating against Windows-Domain using SSPI</h1>
<span class="anchor" id="line-9"></span><p class="line867"><div class="table-of-contents"><p class="table-of-contents-heading">Contents<ol><li>
<a href="#Authenticating_against_Windows-Domain_using_SSPI">Authenticating against Windows-Domain using SSPI</a><ol><li>
<a href="#System_Requirements">System Requirements</a></li><li>
<a href="#Installing_.26_Configuring">Installing &amp; Configuring</a><ol><li>
<a href="#Download_.26_Install_mod_auth_sspi">Download &amp; Install mod_auth_sspi</a></li><li>
<a href="#Apache_Configuration">Apache Configuration</a></li><li>
<a href="#Wiki_Configuration">Wiki Configuration</a></li><li>
<a href="#Edit_UserPreferences">Edit UserPreferences</a></li></ol></li><li>
<a href="#Logging_in">Logging in</a></li></ol></li></ol></div> <span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><p class="line874">For running moin in corporate environment access restrictions has to be enforced reliably. Generally, in these environments, centralized domain authentication is the preferred method.  Fortunately, this is easy to set up with moin 1.5 with the help of the SSPI-plugin for Apache.   This document will take you through the step-by-step for setting this up. <span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><ul><li style="list-style-type:none"><p class="line862">For general information, see <a class="interwiki" href="http://moinmaster.wikiwikiweb.de/HelpOnAuthentication" title="MoinMaster">HelpOnAuthentication</a> <span class="anchor" id="line-14"></span></li></ul><p class="line867">
<h2 id="System_Requirements">System Requirements</h2>
<span class="anchor" id="line-15"></span><ul><li><p class="line891"><strong>Windows 2000, XP, or greater (including server).</strong> <span class="anchor" id="line-16"></span><ul><li>Apache doesn't require Windows Server (unlike IIS), so it's a great way to use an old desktop without requiring a Server license! <span class="anchor" id="line-17"></span></li><li>mod_auth_sspi.so requires Apache on Windows, it will not work with a Linux/Unix install (sadly). <span class="anchor" id="line-18"></span></li></ul></li><li><p class="line891"><strong>Apache 2.0.xx.</strong> <br>
 <span class="anchor" id="line-19"></span></li><li style="list-style-type:none">According to Apache.org, the Apache 1.3 series is not recommended for Windows installs, as it was developed primarily towards unix systems. Apache 2.0.x series is much more Windows-aware and friendly. Also, the mod_auth_sspi plugin requires Apache 2.0.x or later. <span class="anchor" id="line-20"></span></li><li><p class="line891"><strong>a working install of a MoinMoin wiki</strong> <br>
 <span class="anchor" id="line-21"></span></li><li style="list-style-type:none"><p class="line862">These instructions assume you've successfully set up a working moin configuration (based on <a class="interwiki" href="http://moinmaster.wikiwikiweb.de/HelpOnInstalling/ApacheOnWin32" title="MoinMaster">HelpOnInstalling/ApacheOnWin32</a>) and you're expanding to include Domain Authentication. <span class="anchor" id="line-22"></span></li><li><p class="line891"><strong>a Domain Controller </strong> <img alt=";-)" height="15" src="/moin_static163/rightsidebar/img/smile4.png" title=";-)" width="15" /> <span class="anchor" id="line-23"></span></li></ul><p class="line867"><em>note:</em> Older versions of Windows is <em><span class="u">not</span></em> recommended (including Win98, WinME, perhaps even WinNT) due to their obsolete process-handling methods. <span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><p class="line867">
<h2 id="Installing_.26_Configuring">Installing &amp; Configuring</h2>
<span class="anchor" id="line-26"></span><p class="line874">The following section is broken into: <span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><ul><li><p class="line862">downloading &amp; installing the sspi module <span class="anchor" id="line-29"></span></li><li>Configuring Apache http.conf file <span class="anchor" id="line-30"></span></li><li>Configuring Moin wikiconfig.py file <span class="anchor" id="line-31"></span></li><li><p class="line862">editing the UserPreference page so that it's more logical and relevant to domain authentication <span class="anchor" id="line-32"></span></li></ul><p class="line867">
<h3 id="Download_.26_Install_mod_auth_sspi">Download &amp; Install mod_auth_sspi</h3>
<span class="anchor" id="line-33"></span><p class="line862">Before proceeding, make sure that you have a working and tested <a href="/group/MoinMoin">MoinMoin</a> installation.  The last thing you want is to install it all at once, have something not working, and try to reverse-diagnose what went wrong and where. <span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><p class="line867"><span class="u">Download SSPI</span> <span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><ol type="1"><li><p class="line891"><a class="http" href="http://www.gknw.at/development/apache/httpd-2.0/win32/modules/">http://www.gknw.at/development/apache/httpd-2.0/win32/modules/</a> <span class="anchor" id="line-38"></span><ul><li><p class="line862">Download the version that's appropriate to your server.  For example, the file  <tt>mod_auth_sspi-1.0.4-2.0.58.zip</tt> is SSPI version 1.0.4 built against Apache version 2.0.58. <span class="anchor" id="line-39"></span></li><li>This site is nice because it has the modules built against specific Apache versions (no idea is this makes the modules somehow "better" than versions found on other sites). <span class="anchor" id="line-40"></span></li></ul></li><li><p class="line862">Unzip the sspi file, copy the mod_auth_sspi.so file into the Apache <tt>modules</tt> folder (generally located here: <tt>c:\Program&nbsp;Files\Apache&nbsp;Group\Apache2\modules\</tt> <span class="anchor" id="line-41"></span></li></ol><p class="line867">
<h3 id="Apache_Configuration">Apache Configuration</h3>
<span class="anchor" id="line-42"></span><p class="line862">Edit your <tt>http.conf</tt> file (usually found in <tt>c:\Program&nbsp;Files\Apache&nbsp;Group\Apache2\conf\</tt>). Use an appropriate text editor (such as <a class="http" href="http://www.textpad.com">TextPad</a>), avoid using NotePad. <span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><p class="line862">Scroll down to the <tt>LoadModule</tt> section, and add the line at the bottom of this section (this tells Apache to load the mod_auth_sspi.so module): <span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span><p class="line867"><span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><pre><span class="anchor" id="line-1"></span>    LoadModule sspi_auth_module modules/mod_auth_sspi.so</pre><span class="anchor" id="line-49"></span><p class="line862">Now, scroll down to the bottom of the <tt>http.conf</tt> file, and add the following: <span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><p class="line867"><span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><pre><span class="anchor" id="line-1-1"></span>#
<span class="anchor" id="line-2"></span>## Domain authentication using mod_auth_sspi.so
<span class="anchor" id="line-3"></span>#
<span class="anchor" id="line-4"></span>&lt;IfModule !mod_auth_sspi.c&gt;
<span class="anchor" id="line-5"></span>    LoadModule sspi_auth_module modules/mod_auth_sspi.so
<span class="anchor" id="line-6"></span>&lt;/IfModule&gt;
<span class="anchor" id="line-7"></span># Change /mywiki in the line below to match what you have in the separate ScriptAlias line.
<span class="anchor" id="line-8"></span># If you explicitly followed the directions on ApacheOnWin32, this will be /mywiki
<span class="anchor" id="line-9"></span>&lt;Location /mywiki&gt;
<span class="anchor" id="line-10"></span>AuthType SSPI
<span class="anchor" id="line-11"></span>AuthName "Company Internal Wiki - Login using your DOMAIN username and password"
<span class="anchor" id="line-12"></span>Require valid-user
<span class="anchor" id="line-13"></span>SSPIAuth On
<span class="anchor" id="line-14"></span>SSPIAuthoritative On
<span class="anchor" id="line-15"></span># replace the IP address below with the IP of your domain controller:
<span class="anchor" id="line-16"></span>SSPIDomain 192.168.1.15
<span class="anchor" id="line-17"></span>SSPIOmitDomain On
<span class="anchor" id="line-18"></span>SSPIOfferBasic On
<span class="anchor" id="line-19"></span>&lt;/Location&gt;</pre><span class="anchor" id="line-72"></span><span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><p class="line867">
<h3 id="Wiki_Configuration">Wiki Configuration</h3>
<span class="anchor" id="line-75"></span><p class="line862">Now you will need to modify your Moin configuration so that user accounts are automatically created based on their domain authentication. Using an appropriate text editor, open the <tt>wikiconfig.py</tt> configuration file in the root of your moin install (if you followed the instructions on <a class="interwiki" href="http://moinmaster.wikiwikiweb.de//HelpOnInstalling/ApacheOnWin32" title="MoinMaster">/HelpOnInstalling/ApacheOnWin32</a> explicitly, this file will be here <tt>C:\Moin\mywiki\wikiconfig.py</tt>). <span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span><p class="line867"><span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><pre><span class="anchor" id="line-1-2"></span>    ## Domain Authentication using mod_auth_sspi.so
<span class="anchor" id="line-2-1"></span>    from MoinMoin.auth.http import http
<span class="anchor" id="line-3-1"></span>    auth = [http]
<span class="anchor" id="line-4-1"></span>    user_autocreate = True</pre><span class="anchor" id="line-83"></span><p class="line862">At this point, test your wiki and make sure you can successfully login (see the <em>Logging in</em> section below).  Congratulations if all is well! <span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><p class="line862">Optionally, you may want to add further modifications now that you are successfully using domain authentication.  These directives remove links and fields that are no longer relevent with domain authentication.  Back in the <tt>wikiconfig.py</tt> add following in the <em>User Preferences</em> section: <span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span><p class="line867"><span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><span class="anchor" id="line-96"></span><pre><span class="anchor" id="line-1-3"></span>    # Remove the 'logout' link at the top of every page, since it no longer works with domain authentication:
<span class="anchor" id="line-2-2"></span>    show_login = 0
<span class="anchor" id="line-3-2"></span>    #
<span class="anchor" id="line-4-2"></span>    # Remove irrelevant fields from the 'UserPreferences' page:
<span class="anchor" id="line-5-1"></span>    user_form_remove = ['password', 'password2', 'logout',]
<span class="anchor" id="line-6-1"></span>    #
<span class="anchor" id="line-7-1"></span>    # Remove irrelevant checkboxes from the 'UserPreferences' page (disable at Domain Server instead):
<span class="anchor" id="line-8-1"></span>    user_checkbox_remove = [ 'disabled', ]</pre><span class="anchor" id="line-97"></span><p class="line867">
<h3 id="Edit_UserPreferences">Edit UserPreferences</h3>
<span class="anchor" id="line-98"></span><p class="line862">As administrator (you did add yourself as superuser in <tt>wikiconfig.py</tt>, right?! <img alt=";-)" height="15" src="/moin_static163/rightsidebar/img/smile4.png" title=";-)" width="15" /> ), you will want to re-write most of the text on the <a href="/group/UserPreferences">UserPreferences</a> page, since most of it is no longer relevant. I've changed mine to be the relatively simple: <span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span><p class="line867"><span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><pre><span class="anchor" id="line-1-4"></span>At minimum, please fill in the email field. Your email is needed for you to be able to get notifications on page changes.</pre><span class="anchor" id="line-103"></span><p class="line874">You, of course, can add any additional comments to your wiki installation. <span class="anchor" id="line-104"></span><span class="anchor" id="line-105"></span><p class="line867">
<h2 id="Logging_in">Logging in</h2>
<span class="anchor" id="line-106"></span><p class="line874">With normal browsers like mozilla or firefox you have to enter 'domain\username' as username and your password. Only IE shows a dialog with three fields (sometimes) instead of two: name, domain, password. <span class="anchor" id="line-107"></span><span class="anchor" id="bottom"></span></div>
<div id="pagebottom"></div>
</div>


<div id="footer">
<ul id="credits">
<li><a href="http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>
</html>


