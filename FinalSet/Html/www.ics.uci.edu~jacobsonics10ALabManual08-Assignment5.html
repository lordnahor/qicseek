<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.79 (Macintosh; U; PPC) [Netscape]">
   <title>Dialysis Database</title>
<link rel="stylesheet" href="../course.css" type="text/css">
</head>

<body>

<div class="title">
<center>
<h2>Dialysis Database</h2>
<h4>Assignment 5</h4>
</center>
</div>

<p>In this exercise, you (begin to) develop a database of kidney dialysis patient data. You prepare a data entry screen to accept information about patients, calculate some results based on the entered data, and place selected results in a summary report. In doing these tasks, you become familiar with data processing chores common to scientific inquiry, learn to use a database as a reporting and investigative tool, and apply a number of the information representation and presentation concepts we&#146;ve discussed.</p>

<div class="section">
<hr>
<h3>What to Turn In</h3>
</div>

<p>&bull; An electronic copy of the database you created</p>


<div class="section">
<hr>
<h3>Grading</h3>
</div>

You will be graded on the correctness, completeness, and presentation of your layouts, on how well you have structured your database (its representation), whether your database contains the required fields with correct attributes, and how well it checks for input errors.  Be prepared to show your database and layout in action, should the TA so request.


<div class="section">
<hr>
<h3>Background</h3>
</div>

<p>A person&#146;s kidneys can stop working, usually because of trauma (injury) or disease. Sometimes they will recover their function, but if they fail for good, the body can&#146;t remove the (poisonous) by-products that come from its own metabolic processes and, in a few days, the person dies. Rather grim. However, these days there are three major treatments that can compensate for the lethal effects of &#147;end stage renal disease&#148; (ESRD, for short).</p>

<p>The first is &#147;hemodialysis.&#148; Two or more times a week, a person is &#147;hooked up&#148; to a dialysis machine. The patient&#146;s blood is routed through a complex system of filters and chemicals that remove the toxins. The treatment can take a few hours; it&#146;s mind-bogglingly expensive (hundreds of dollars per <i>treatment</i>); there&#146;s some danger of infection and side effects. It&#146;s also typically not quite as effective as the kidneys, so, over time, a patient often has to increase the number or duration of treatments. It&#146;s so psychologically taxing (imagine having your life literally and completely dependent upon a machine) that some patients need ongoing psychological counseling.</p>

<p>The second is a kidney transplant. A healthy kidney, from a &#147;matched&#148; living or dead donor, is surgically placed into the ailing patient. This is major surgery, with its attendant dangers and costs, both to the dialysis patient and the live donor. The transplant patient is often on (expensive) drugs indefinitely to prevent the body from rejecting the kidney. The patient usually doesn&#146;t need dialysis for some time, but, eventually, often does (but not as often, typically, as before the transplant). Sometimes the new kidney stops functioning, and the patient must get another transplant or go back on full-blown dialysis.</p>

<p>The third is a class of dialysis treatments where the patient wears a filtration system that&#146;s partially in the abdominal wall and partially external; the external &#147;bag&#148; is replaced every so often. It&#146;s fairly effective, but often not as effective as hemodialysis. Surgery, with its risks, is required to install the &#147;interior portion&#148; of the system.  Because of the external/internal connection and bag changing, major infection is a common problem, often resulting in hospitalization, and sometimes (at least temporary) discontinuance of this approach and a turning to hemodialysis or transplantation. The most common form of this dialysis technique is called CAPD. (That abbreviation often stands for the entire class of these techniques; so it will in this exercise). </p>

<p>Because all these alternatives are so expensive, the federal government picks up the tab. The government mandates that dialysis treatment facilities and transplant hospitals keep detailed records on patients with ESRD: It is quite interested in tracking how its money is being spent, in detecting and stopping fraud, and in learning which treatments are the most cost-effective. The collected data is forwarded to the ESRD Networking Coordinating Council&#151;&#147;the Network,&#148; for short&#150;a national group of offices that insures the accuracy of and prepares reports about the data (among many other duties). </p>

<p>Each Network office also typically prepares several monthly reports. Some provide profiles of the patient population or the facilities at which they were treated; others point up missing or inconsistent data, so the office can call the appropriate facility and clear up the problem. Each office sends some of these data to CMS to add to its national dialysis information bank.</p>

<p>The Network and CMS databases are also available to qualified researchers. There&#146;s much about treating ESRD that is still unknown, especially about which treatments are most effective in which patient populations, an issue you can tackle, if you like, as optional work.</p>

<p>For more information about the ESRD Networks and the data they collect, see <font face="Geneva" size=2><a href= "http://www.esrdnetworks.org">www.esrdnetworks.org</a></font>; for more about CMS, see <font face="Geneva" size=2><a href= "http://www.cms.hhs.gov"</font>www.cms.hhs.gov</a>.</p>

<h4>About databases, briefly</h4>

<p> A modern database contains the data itself, command sets (often called <i>macros</i>) that manipulate the data, <i>forms</i> that describe how data should appear on the screen, and <i>report layouts</i> that describe how data should appear on printed reports. The data is stored in one or more <i>tables. </i>Each row of a table is one <i>record</i> or <i>instance</i> of the data (in our case, a patient); each column is a <i>field</i> that contains an attribute that applies to all records (our fields include birth date and date of first dialysis, among others). Along with each field is information about its characteristics; for example, for birth date we might store that the field&#146;s name is DOB, that it is a date and that the date is stored in a particular format. Databases are designed so that it is straight-forward to do computations (say, grouping of records according to some criterion or counting the number of records that have a gender of female), retrieve subsets of information, sort records, and prepare reports.</p>

<h4>The codebook</h4>

<p>To maintain and analyze data properly, one must know its attributes. These include its data type, its size, and, if the data is a code for something, what each value of the code means. This information is commonly placed in a <i>codebook</i>. The table below shows the codebook for the dialysis information that will be stored in the database for this exercise. <i>dx</i> is an abbreviation for dialysis, <i>tx</i> for transplant. By the way, designing codebooks is a craft all its own, one with its own set of representational and presentational issues.</p>

<table cellspacing=0 border=1 cellpadding=4 width=700>
<tr><td width="11%" valign="TOP" >
<u><p>Attribute Name</u></td>
<td width="14%" valign="TOP">
<u><p>Type</u></td>
<td width="8%" valign="TOP">
<u><p>Size</u></td>
<td width="67%" valign="TOP">
<u><p>Description</u></td>
</tr>
<tr><td width="11%" valign="TOP">
NetID</td>
<td width="14%" valign="TOP">
Numeric</td>
<td width="8%" valign="TOP">
5</td>
<td width="67%" valign="TOP">
identification number; unique to each patient; assigned by the database as a new patient&#146;s data is entered</td>
</tr>
<tr><td width="11%" valign="TOP">
MissDeth</td>
<td width="14%" valign="TOP">
Character</td>
<td width="8%" valign="TOP">
1</td>
<td width="67%" valign="TOP">
X&nbsp;&nbsp;if a patient has died but the official death notice form 
<br>&nbsp;&nbsp;&nbsp;has not been received, 
<br>blank otherwise</td>
</tr>
<tr><td width="11%" valign="TOP">
DOB</td>
<td width="14%" valign="TOP">
Text</td>
<td width="8%" valign="TOP">
8</td>
<td width="67%" valign="TOP">
Date of birth in MMDDCCYY format
<br>MM = 99 when month is unknown
<br>DD = 99 when day is unknown
<br>CC = century; can only be 18, 19, 99 or 20;
<br>&#9;99 = year of birth unknown
<br>YY = remainder of year (blank if CC = 99)</td>
</tr>
<tr><td width="11%" valign="TOP">
Gender</td>
<td width="14%" valign="TOP">
Character</td>
<td width="8%" valign="TOP">
1</td>
<td width="67%" valign="TOP">
X - unknown</p>
<br>F - female</p>
<br>M- male</td>
</tr>
<tr><td width="11%" valign="TOP" >
ICDA5</td>
<td width="14%" valign="TOP">
Numeric</td>
<td width="8%" valign="TOP">
5</td>
<td width="67%" valign="TOP">
Standard, national disease codes; used to indicate disease that lead to dx</td>
</tr>
<tr><td width="11%" valign="TOP" >
DeathDate</td>
<td width="14%" valign="TOP">
Text</td>
<td width="8%" valign="TOP">
8</td>
<td width="67%" valign="TOP">
Date of death in MMDDCCYY format
<br>MM = 99 when month is unknown
<br>DD = 99 when day is unknown
<br>CC = century; can only be 19, 99 or 20;
<br>99 = year of birth unknown
<br>YY = rest of year (is blank if CC = 99)
<br>entire date is blank if patient is alive
</tr>
<tr><td width="11%" valign="TOP">
DeathPri</td>
<td width="14%" valign="TOP">
Numeric</td>
<td width="8%" valign="TOP">
<p>2</FONT></td>
<td width="67%" valign="TOP">
Primary cause of death
<br>0 - patient alive</td>
</tr>
<tr><td width="100%" valign="TOP" colspan=4>
The information about each event is stored as a triplet: the event itself (as a code), the date it occurred, and the facility at which it occurred. Three triplets are stored. The first set is Event1, EvDate1 and EvFac1; the second is Event2, EvDate2 and EvFac2; the third is Event3, EvDate3, and EvFac3.</td>
</tr>
<tr><td width="11%" valign="TOP">
Event<i>x</i></td>
<td width="14%" valign="TOP">
Numeric</td>
<td width="8%" valign="TOP">
2</FONT></td>
<td width="67%" valign="TOP">
Event 
<br>0: no event
<br>1: hemodialysis at a facility
<br>4: hemodialysis at home
<br>11 - 13: CAPD
<br>16: recovered function
<br>17: discontinued dx, patient&#146;s choice
<br>31-39: tx
<br>97: changed facility (only; no dx change)
<br>99: death</td>
</tr>
<tr><td width="11%" valign="TOP" >
EvDate<i>x</i></td>
<td width="14%" valign="TOP">
Text</td>
<td width="8%" valign="TOP">
8</td>
<td width="67%" valign="TOP">
Date event occurred, MMDDYY
<br>MM = 99 when month is unknown
<br>DD = 99 when day is unknown
<br>CC = century; can only be 19, 20 or 99;
<br> &nbsp;&nbsp:99 = year unknown
<br>YY = 99 when year is unknown
<br>if year is unknown, entire date is considered missing, 
<br>&nbsp;&nbsp;code 99999999.
<br>entire date is blank if event not yet occurred</td>
</tr>
<tr><td width="11%" valign="TOP" >
EvFac<i>x</i></td>
<td width="14%" valign="TOP">
Text</td>
<td width="8%" valign="TOP">
6</td>
<td width="67%" valign="TOP">
Code for facility at which event occurred
<br>999999 = unknown
</tr>
</table>
<p>Note that dates are stored as text, rather than as a date type, because date types cannot handle a date with a missing month, day or year, or one that is blank. In real-world data, missing values pretty much always occur, and are important to consider in data analysis.</p>

<div class="section">
<hr>
<h3>Getting Help from Access</h3>
</div>

<p>We will be using Microsoft Access 2003 as our database tool.</p>

<p>Before diving into Access, it is worthwhile to take a moment
to introduce you to its extensive help features. This lab will guide you through
the process of developing your database, but there will likely be times where
you want more information. And learning to use help features is an important
general computing skill.</p>

<p clas>Most features in Access print out help messages as you use
them. For example, when you enter the properties for database fields (see
below), Access will print out a helpful message whenever you go to set a
particular property. In many
places in Access, hitting the F1 key will bring up more help.</p>

<p>Perhaps the easiest way to get general help is to use the &#147;Office
Assistant,&#148; a context-sensitive help feature that is very easy to use,
and really quite good at providing information. To activate it, just select Show
the Office Assistant from the Help menu. Click on the paperclick animation, then
type in your question and click on <font class = "codeFaceSmall">Search</font>.
</p>

<p>You can also use the other features under the <font class = "codeFaceSmall">Help</font> menu; in particular, the first option, <font class = "codeFaceSmall">Microsoft Office Access Help, </font>activates the
full-blown Access help feature. There are other help features available; do
experiment!</p>

<div class="section">
<hr>
<h3>Part I: Data Entry and Validation</h3>
</div>
<h4>Preparing for the data</h4>

<p>The first task when creating
a database to hold new information is to create an empty database with the
appropriate fields and associated attributes.</p>

<p>&bull;  Launch Access. To do so, choose Programs from the<font class = "codeFaceSmall">Start</font> menu, then <font class = "codeFaceSmall">Microsoft Office</font>, then <font class = "codeFaceSmall">Microsoft Office Access 2003</font>. </p>

<p>&bull; In the right-hand <font class = "codeFaceSmall">Getting Started</font> box that
appears, select <font class = "codeFaceSmall">New...</font>; it&#146;s under
<font class = "codeFaceSmall">Open</font>.</p>

<p>The right column will change to show a number of options
under <font class = "codeFaceSmall">New</font>. </p>

<p>&bull; Choose <font class = "codeFaceSmall">Blank database...</font></p>

<p>The <font class = "codeFaceSmall">File New Database</font>
dialog box appears, which allows you to give a name to your database and store
it. To match the instructions here</p>

<p>&bull; Name the database file <font class = "codeFaceSmall">kinfo.mdb</font> (type <font class = "codeFaceSmall">kinfo.mdb</font>
into the <font class = "codeFaceSmall">File name:</font> box) and store it in the <font class = "codeFaceSmall">\Temp </font>folder (using the <font class = "codeFaceSmall">Save in:</font>
menu at the top of the dialog box to position the file there). Click on <font class = "codeFaceSmall">Create</font> to save the database file.</p>

<p>The Database dialog box will appear; it has a choice down
its left-hand size for each kind of information that (can be) stored in a
database (which we&#146;ll use later) and a main menu that shows three ways to
create the database.</p>

<p>&bull; Click on <font class = "codeFaceSmall">Create table in Design view</font>; click on
<font class = "codeFaceSmall">Open</font>.</p>

<p>You&#146;ll now see a grid with a place to enter in each
field (<font class = "codeFaceSmall">Field Name</font>), the kind of data it
holds (<font class = "codeFaceSmall">Field Type</font>) and a <font class = "codeFaceSmall">Description</font> (helpful comments about the
field). As you enter the field name, a menu will appear in the <font class = "codeFaceSmall">Data Type</font> next to it; you will choose the most
appropriate type for the field. When you choose a type, a properties list will
appear in the <font class = "codeFaceSmall">General</font> tab at the lower
left of the table box; these properties can be changed as needed. The lower
right of the table box always shows informational help as you do your work.
Hitting the F1 function key will call up additional help&#151; do use it as
needed.</p>

<p>&bull; Using the codebook as your guide, enter a <font class = "codeFaceSmall">Field Name</font>,
a <font class = "codeFaceSmall">Data Type</font> and a <font class = "codeFaceSmall">Description.</font> (You can also adjust <font class = "codeFaceSmall">Field Properties</font> for each field at this time,
or wait until you&#146;ve entered all the fields. We discuss more about
field properties below.) </p>

<p>Make the field names meaningful, and ones that can easily be
matched to the correct field information in the codebook. The data type is just
that, an indicator of the kind of data to be stored in that field. Having type
information helps Access know what symbols are legal in a field&#146;s
value (e.g., numbers can&#146;t include punctuation) and what operations
involving that field make sense (e.g., text fields cannot meaningfully be
multiplied together). </p>

<p><font class = "codeFaceSmall">Text</font>, <font class = "codeFaceSmall">Number</font> and <font class = "codeFaceSmall">Yes/No</font>
field types are just that. A <font class = "codeFaceSmall">Memo</font> field
is essentially a huge text block; it allows for entering a large amount of text
data. <font class = "codeFaceSmall">Date/Time</font> lets you store date and
time information. <font class = "codeFaceSmall">Currency</font> lets you
store (monetary amounts, such as U.S. dollars. <font class = "codeFaceSmall">AutoNumber</font>
has Access automatically put a number into this field as the record is created.
Hyperlink stores a link to a Web page; <font class = "codeFaceSmall">OLE
Object</font> stores a link to data the database needs access to that is not
stored in the database itself. The <font class = "codeFaceSmall">Lookup
Wizard</font> helps you set up a table that lists the legal values for the
field; during the entry of a patient's data, the user chooses a value from that
list. You can learn more about these types by hitting the F1 key.</p>

<p>Note that you can&#146;t use a Yes/No field if the
possible answers are &#147;Yes,&#148; &#147;No,&#148; and such
things as &#147;refused to answer&#148; or &#147;question not
asked&#148;: Yes/No fields can only store two values, Yes and No. Note too
that <font class = "codeFaceSmall">Date/Time</font> does not allow for any missing parts (e.g.,
if you had a date with a missing day, there would be no way to store it as a
date without &#147;making up&#148; a day)&#151;so that means,
unfortunately, you can&#146;t use the Date/Time type for any field that may
contain values representing missing data. </p>

<p>If you enter a field in error, you can delete it by
highlighting <i>all</i> of its information (by
clicking on the gray box at the far left of the field line), and hitting the
delete key.</p>

<p><i>Make sure you get the data types right before proceeding
on to other tasks!</i> Changing them later is
doable, but often very messy and time-consuming! </p>

<h4>Some examples</h4>

<p>To help you get a feel for all this, here&#146;s some fields and their data
types; each field uses a different kind of data type. You should not need to
use data types other than those shown here (hint, hint!).</font></p>

<p>NetID: The appropriate field type is <font class = "codeFaceSmall">AutoNumber</font>, 
as the codebook says the database should
automatically provide this ID.</p>

<p>DOB: We cannot use a Date/Time type, as that will not allow for the invalid dates we use to
denote missing data. The best type for it is <font class = "codeFaceSmall">Numeric</font>,
since it has to be all numbers. </p>

<p>Gender: This is limited to three text values, F, M, and X.
So we use a lookup table with these three values. We choose Lookup Wizard... then
<font class = "codeFaceSmall">I will type in the values that I want</font>
from the wizard&#146;s dialog box, then click <font class = "codeFaceSmall">Next</font>.
On the next box, I tell the wizard I only want 1 column and enter into that
column the three values for the list, that is F, M and X,, then click <font class = "codeFaceSmall">Next</font>. On the following screen I use the name <font class = "codeFaceSmall">Gender</font> for the list and then <font class = "codeFaceSmall">Finish</font>. If you now click on the Lookup tab at the lower left of the table screen, you&#146;ll see the information from the
wizard, confirming that your list has been created.</p>

<p>You may have noted that the data types chosen don&#146;t
necessarily match those given in the codebook. That&#146;s ok because the
codebook describes how the data is to appear when it is transferred from one
party to another; as long as we abide by its formats when we share data, we can
store the data any way we want in the database (and convert it to the types in
the codebook when we prepare it for sharing with others).</p>

<h4>Ensuring data accuracy</h4>

<p>A paramount rule of database design is to have the database catch every
possible error at the time of data entry. Incorrect data in the database leads
to incorrect reports, analyses, and conclusions, and they can lead to bad
policy and terrible consequences. An example&#151;this is a true story...</font></p>

<p>A water district that supplies
the Los Angeles area had to change some of the chemicals it used to purify the
water (the reasons are interesting, but too long to go into here). Trouble was,
anyone on hemodialysis treated with this changed water would die: Compounds
formed in the water would react with chemicals in the dialysis machine, and the
resulting poisonous substance would enter the patient&#146;s blood during
treatment. So, the L.A. ESRD network went to its database, and pulled up
contact information for dialysis facilities and for people being treated at
home. It notified every one of them about the situation and what to do about it
(which was to install a special filter between the water supply and the
dialysis machine). The Network was the only location that was required to have
on file all dialysis patients in the area. Although the media was broadcasting
the change, and other organizations were doing their best to notify the
&#147;interested parties,&#148; it fell to the Network to make sure all
were indeed notified. Imagine the consequences of error: for instance, a whole
facility of poisoned patients because the facility&#146;s code in the
database was incorrect, or a home dialysis patient dying because a data error
indicated the patient was dead&#151;so of course she did not need to be
contacted!</p>

<p>Properties in fields interact,
sometimes in unexpected ways, with properties in input screens or reports. For
instance, if a restriction on the range of numbers that can appear in a numeric
field is given in the table, and a different restriction is placed on the field
when its value is entered from a screen, difficult-to-fix contradictions can
occur. So, a general rule: if a property is going to apply to a field on all
screens that use it, set the property in the table. If not, set the properties
in the screen(s) as appropriate. It is critical in a real-world system that the
properties be set, wherever they are set, so that any incorrect data values
entered on a screen that can be caught are caught. (Some errors cannot be
caught: if you meant to enter a birth date of 05062004 and instead entered
05072004, there is no way the database can catch that, as both birth dates are
perfectly legal and reasonable values. We catch <i>all</i> of what we <i>can</i> catch.)</p>

<h4>Some examples, revisted</h4>

<p>To illustrate setting
field properties, here we set
them for the fields we discussed above. In general, to change a property, click
on its box.</p>

<p>NetID: The existing field size of long integer will allow
for very large numbers, which in turn allows for lots of patients&#151; just
what we want. <font class = "codeFaceSmall">New Values</font> set to <font class = "codeFaceSmall">Increment</font> does the automatic numbering we
desire. The user is not going to enter this field, so we do not need a <font class = "codeFaceSmall">Format</font> or <font class = "codeFaceSmall">Caption</font>.
(Remember, these properties apply to the table; we can have captions and
formatting on a screen or report if we want by defining them there.) <font class = "codeFaceSmall">Indexed</font> is currently allowing duplicate
values, not what the codebook calls for. So click on the <font class = "codeFaceSmall">Indexed</font> property box to get a list of
available choices and pick <font class = "codeFaceSmall">Yes(No Duplicates)</font>,
which is what we want; each network ID is to be unique. </p>

<p>DOB:. The largest value this field can be is 99999999.
That's pretty big for a number, so we leave the <font class = "codeFaceSmall">Field
Size</font> set at <font class = "codeFaceSmall">Long Integer</font>.
Formatting is best left to screens and forms, so we leave it blank here.
Decimal places will always be 0, so we change the property to 0. Input masks
are best left to input screens. Captions, too are best left to screens. We
leave the <font class = "codeFaceSmall">Default Value</font> at 0; during
data entry, it will be changed to a real birthday (or the value for a missing
one) so the 0 should not remain in a real patient&#151;and if we see a 0
somewhere in the database, we know we have an error that needs to be fixed, not
something we would notice if we used a default value that corresponded to a
legal birth date. We leave the validation rules and messages to the data entry
screens. We do, however, change this field&#146;'s <font class = "codeFaceSmall">Required</font> property to <font class = "codeFaceSmall">Yes</font>;
every patient will have a birthday, even if it is the phony missing value one.</p>

<p>Gender: This is limited to three text values, F, M, and X,
so the <font class = "codeFaceSmall">Field Size</font> of 50 is
inappropriate; we change it to 1. We change <font class = "codeFaceSmall">Required</font>
to <font class = "codeFaceSmall">Yes</font> and <font class = "codeFaceSmall">Allow Zero Length</font> to <font class = "codeFaceSmall">No</font>,
as we always want a code from the table present. We leave the other properties
as they are.</p>

<p>&bull; Adjust the field properties of each field as necessary, keeping the above rules in
mind. Read the help messages and use the F1 key as needed to get help on
specific properties.</p>

<p>&bull; To protect your work against loss, every now and again save it via the <font class = "codeFaceSmall">Save</font> command (under the <font class = "codeFaceSmall">File</font> menu). The first time you save the table,
you will be asked to provide a name; call it KINFO to have its name match the
one we use here. Of course, also save your table when you are done creating it.</p>

<p>When you save the table, you may be warned that there is no
primary key defined. It turns out we do not need one; we would if we had
multiple tables in the database, but we will be only using one. So, if this
message comes up, click on <font class = "codeFaceSmall">No</font>. </p>

<p>If you are working on the table in more than one session,
you can get to it easily by double-clicking on the kinfo.mdb database (which,
of course, launches Access and open the kinfo database). You may get a security
warning; click <font class = "codeFaceSmall">Open</font> if you do. When the
database window appears, click on <font class = "codeFaceSmall">KINFO</font>,
then <font class = "codeFaceSmall">Design</font>, to continue your work.</p>

<p>We strongly encourage you to have the TA review your table
before you continue with this lab. As we said above, it&#146;s much easier
to fix any mistakes in the table now (while nothing else depends on it) than
later, when changing the table will often necessitate major changes in other
parts of your work.</p>

<h4>The data entry screen</h4>

<p>Adding new data to a database, deleting incorrect information, and keeping its data
up-to-date and correct is a common, ongoing chore. To make the addition,
deletion, and changing of data (often called &#147;data
maintenance&#148;) easier and less error-prone, we want our screen layouts
to group together related data, have meaningful labels for the fields, use good
typography and judicious use of color to make them easy to read, and to have
the database prevent the user, as much as it can, from entering invalid data
values. So your next task is to prepare a &#147;data entry screen&#148;
for this database.</font></p>

<p>&bull;  Go to the Database window. Click on <font class = "codeFaceSmall">Forms</font>; Click on <font class = "codeFaceSmall">Create
form by using wizard</font>; be sure the KINO table appears in the <font class = "codeFaceSmall">Table/Queries</font> box, and follow the
instructions! </p>

<p>There are several ways to create a form, but start with the
form wizard; it does a lot of work for you but still gives you a nice set of
options to customize your form. Do feel free&#151;even
encouraged&#151;to create screens using the other available options.</p>

<p>The last screen of the form wizard asks if you wish to
modify the form, or view it. For now, tell Access you want to view your form,
so you can review it. You can (and probably will) want to modify your form at
some point to make it easier to find related fields, add screen or subgroup
headings, change colors, and so on. To do so, just click on <font class = "codeFaceSmall">Forms</font>, click on the name of your form and
select <font class = "codeFaceSmall">Design</font>. You&#146;ll be placed
into the design tool. It looks complex, but is actually quite straightforward
to use. Again, use the various help features and <i>experiment</i>; you&#146;ll be surprised how much you can do,
and do easily, to improve your screen. (Try, for instance, typing
&#147;validation&#148; into the Help Assistant&#146;s query box and select </font><font class = "codeFaceSmall">Validate or restrict data in a form</font>.
you&#146;ll get lots of information on how to set up input masks and
validation rules for your input form).</p>

<h4>Checking your work</h4>

<p>&bull; Enter some data to test your screen organization and field definitions. There
are several ways to enter data into the database. Perhaps the easiest is to select
<font class = "codeFaceSmall">Forms</font> and double-click on the data entry
form. The screen will appear; start entering data. Experiment with the record
positioning buttons (the bottom of the form) until you are comfortable with
using them. You enter values for fields by typing; you can move from one field
to the next by clicking next to the field name (or wherever you placed the
&#147;box&#148; in which that field&#146;s contents should go, if
you changed its position in your layout). </p>

<p>You can change the values of existing fields by simply
clicking on their data entry boxes and changing the contents in them or, if the
values come from a lookup table, by clicking on the arrow next to the field.
Access will not leave a field (once entered) that fails to meet its data
validation checks; instead, it will present an error message. When you dismiss
the message, you will still be in the field. (Note that when you first create
your form, virtually no validation checks are in place&#151;about all that
it will check is that there is no text in numeric fields.)</p>

<p>You can use the record positioning buttons on the bottom of
the form to move from one record to another. Access will not let you leave a
record if <i>any</i> data field in it is still
in error. Be observant: if you try to leave an in-error record, say from field
X, an error message will appear that may have nothing to do with field X, but
is related to another field that has an error.</font></p>

<p>Don&#146;t just pick obviously correct data values; pick
ones known to be wrong and see if your database catches the mistakes. If it
doesn&#146;t, modify the data entry form, if possible, so they are caught.
You won&#146;t be able to catch every possible mistake, since someone might
enter a legal, but wrong, data value in a field, and because Access&#146;
data validation tools can&#146;t check everything you might want. But do
catch as many errors as you can. If the check is complex, start with doing part
of the checking, make sure it works, then add more to it, check that, and so
on, until you have the complete check in place&#151;it&#146;s a lot easier to
find and correct mistakes this way then trying to figure out what&#146;s wrong in a
complex check.</p>

<p>&bull; Test your data entry checking rigorously. When you are done, make sure your database has at least 10 &#147;clean&#148; records of data in it.
(You&#146;ll need them for the remainder of this exercise.) </p>

<h4>Improving the screen layout</h4>


<p>Now that you&#146;ve had some practice using your screen, you may have thought
of some ways to improve its appearance, perhaps even change it so it is more
likely a data entry person will make fewer mistakes.</p>

<p>&bull; Modify your screen as appropriate; you goal is to have the easiest to read and use
screen that you can. <b></b></p>

<div class="section">
<hr>
<h3>Part II: Computing New Fields</h3>
</div>
<h4>Calculated fields</h4>

<p>It is often very hard to discern patterns in raw data, so we use formulae to
compute  from the data new values that are more meaningful to us. Deciding what
data to collect is, in fact,  often predicated upon the kinds of
&#147;higher level&#148; information desired.</p>

<p>For example, the &#147;event timeline&#148; in this
database reflects reality well. A patient begins dialysis (or gets a
transplant) on a given date at a certain facility. That patient is considered
to be in that &#147;mode&#148; until some other
&#147;event&#148; occurs to change it; moving to CAPD, for example. The
new mode, the date it occurred, and the facility now responsible for the
patient (which might be the same one as before, or might not) is recorded. The
old mode ends on the date the new one begins. Mode changes are tracked until
the patient dies or leaves the local network, both of which are modes
themselves. A special mode code is used to indicate that the patient changed
facility, but that the mode itself did not change. (A patient who left the
network and comes back is also considered to have had a facility change event).</p>

<p>But the timeline (and other fields) don&#146;t directly
provide information of daily interest to a Network. For instance, a
patient&#146;s current dialysis facility&#151;the
place where dialysis was last done&#151;is often needed. Searching the
event timeline for it would work, but it&#146;s slow and error-prone
compared to just looking on the screen for the current facility. So we want to
compute this field, have it updated every time data used to compute it changes,
and have it stand out on the screen.</p>

<p>We&#146;ll step you through
this variable&#146;s computation; it will serve as an example of how
computations are done in Access (and many other modern databases). </p>

<p>We need a place to store the results this new field
contains. Since our purpose in creating it was to allow the person viewing the
dialysis data a quick way of seeing the current dialysis facility, we store
this new field on the data entry form. (There are other places one could store
the field, such as in a report separate from the data entry form; doing so
would make the results available to a different &#147;user class,&#148;
one that cared only about summary results. We&#146;ll get a feel for that
class&#146; needs in Part III of this assignment.)</p>

<p>&bull;  Go to the form you created for data entry and open it in
design view. Expand the form&#146;s window so you have access to more of the
form layout. Place the mouse just above the <font class = "codeFaceSmall">Form
Footer</font> bar so that mouse turns into a cross and drag the moust down so
that the detail area of the form is enlarged. Then, from the <font class = "codeFaceSmall">Toolbox</font>, click the <font class = "codeFaceSmall">Text Box</font> icon (second row, second column). Then click on the
wizard icon directly above it. (Activating the wizard will do related tasks for
you, such as creating a label field to go with this text field). The mouse
should turn into an arrow with <font class = "codeFaceSmall">ab</font> in a
box next to it.) Place the mouse in the detail area where you want the
upper-left corner of the text box to be on the screen, and drag the mouse to
make the text box; let go of the mouse button when the box is the size you
want. (Note that a companion label is created.)</p>

<p>This box can now contain text of any kind, including a<i>
formula</i>.</p>

<h4>About formulas</h4>

<p>A formula is an algebraic-like expression that produces a result; it computes new
values from existing ones. It can be quite simple or very complex.</font><b></b></p>

<p>When entering complex formulas, don&#146;t enter them
all at once. Start with a simple component of it; check it. When it works
right, add another component, and check that part, and so on, building up the
formula piece by piece until you have it all. </p>

<p>For example, we use the IIf statement in several formulas we
ask you to write for this assignment. IIf looks like this:</p>

<p><font class = "codeFaceSmall">IIf(<i>condition</i>, <i>what-to-do-if-true</i>, <i>what-to-do-if-false</i>)</font></p>

<p>and it can be <i>nested</i>,
a powerful mechanism for computing results, but one that results in a complex
expression.</p>

<p>Suppose you want to enter the following formula. (Don&#146;t worry right now about
what it does; we&#146;ll get to that presently.)</p>

<font class = "codeFaceSmall">
<p>=IIf([Event3] &lt;&gt; 0 And [Event3] &lt; 16, [EvFac3], IIf([Event2] &lt;&gt; 0 
<br><font class = "codeFaceSmall">And [Event2] &lt; 16, [EvFac2], IIf([Event1] &lt;&gt; 0 And 
<br>[Event1] &lt; 16, [Event1], 0)))</p>
</font>

<p>It&#146;s best to start with </p>

<p><font class = "codeFaceSmall">IIf([Event1] &lt;&gt; 0 And [Event1] &lt; 16, [Event1], 0)</font></p>

<p>and check that it works right for event 1. Then expand the formula to</p>

<p><font class = "codeFaceSmall">IIf([Event2] &lt;&gt; 0 And [Event2] &lt; 16, [EvFac2], 
<br>IIf([Event1]&lt;&gt; 0 And [Event1] &lt; 16, [EvFac1], 0))</font></p>

<p>You know the formula works for <font class = "codeFaceSmall">Event1</font>, so you only have to check it for <font class = "codeFaceSmall">Event2</font>.</p>

<p>Continue by adding <font class = "codeFaceSmall">Event3</font>.
It may not seem like it, but incremental construction, with tests done after
each step, is much faster and more effective at finding and fixing mistakes
than trying to check the entire formula at once. </p>

<p>&bull; Place the cursor in the text box; right click and choose <font class = "codeFaceSmall">Properties</font>. Click on the <font class = "codeFaceSmall">Data</font>
tab and, in the <font class = "codeFaceSmall">Control Source</font> box,
right click and select <font class = "codeFaceSmall">Zoom...</font>. (This
action gives a large typing space). Now enter the above formula, doing it
piecemeal, as illustrated above. <i>Don't hit the </i><font class = "codeFaceSmall"><i>Enter</i></font><i> key</i> when the
formulas get long enough to &#147;overfill&#148; a line: the formula
will wrap to a new line automatically. Enter <font class = "codeFaceSmall">OK</font> to store formulas. If Access detects something wrong with the
a formula,it will give you an error message when you try to leave this field;
if that happens, return to the formula and fix it. </p>

<h4>Interpreting formulas</h4>

<p>The formula will indeed appear much like shown above&#151;Access
doesn&#146;t employ good rules of presentation here, does it? (This
ugliness illustrates why we should do our best to make our work readable; text
is much tougher to understand when it isn&#146;t presented well.) Here's
the same formula, formatted a bit, to make it easier for you to reference while we
discuss it:</font></p>

<font class = "codeFaceSmall">
<p>=IIf([Event3] &lt;&gt; 0 And [Event3] &lt; 16, [EvFac3], 
<br>&nbsp;&nbsp;IIf([Event2] &lt;&gt; 0 And [Event2] &lt; 16, [EvFac2], 
<br>&nbsp;&nbsp;IIf([Event1] &lt;&gt; 0 And [Event1] &lt; 16, [EvFac1], 0))) 
</p></font>

<p>Fields in formulas are referred to by name and enclosed in
square brackets. Numeric constants (0 above) are just written down; text (none
is used above) is enclosed in double quotes (&quot;). An operator is written
between its operands (or in front of it when there is only one operand, as in
-2). <font class = "codeFaceSmall">&lt;&gt;</font> is &#147;not equal
to,&#148; <font class = "codeFaceSmall">&lt;</font> is &#147;less
than,&#148; <font class = "codeFaceSmall">And</font> is a <i>logical
operator</i> that takes on the value <i>true</i> when both of its operands are </font><i>true</i>, and takes on the value <i>false</i> otherwise.</p>

<p>Functions calculate results. You provide the function with
data to work with, called <i>arguments</i> or </font><i>parameters</i>; it computes a result and returns it to you. We use the
IIf function in
the formula above. The IIf
function has three arguments. IIf
first evaluates the first argument. If it is true, it returns the value of the second argument; 
if false, it returns the value
of the third argument. We can nest functions to have the result of one function
used as an argument of another. Seems strange, perhaps, but it does the job. If
you interpret the IIf statement above, it would go something like this:</p>

<p>If event 3 is a hemodialysis
(&#147;hemo&#148;) event, return its facility, otherwise
<br>&nbsp;&nbsp;If event 2 is a hemo event, return its facility, otherwise
<br>&nbsp;&nbsp;&nbsp;&nbsp;If event 1 is a hemo event, return its facility, otherwise 
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0 (to mean
&#147;there is no current dialysis facility&#148;)</p>

<p>Since events are (supposed to be) given in chronological
order, this formula returns the facility at which the patient had the most
recent dialysis event&#151;just what we want.</p>

<p>Another way to enter formulas is by clicking on <font class = "codeFaceSmall">Build...</font> when you are in the text box. This
action lets you call up one of three different tools that can let you build expressions. <font class = "codeFaceSmall">Expression Builder</font>. It&#146;s quite
straightforward to use (with a little&#151;and we do mean a
little&#151;practice), and you may find it an easier approach to entering
formulas then typing them. (The Expression Builder will help you avoid spelling mistakes,
misplaced commas, and unbalanced parentheses, all of which plague anyone trying
to enter formulas correctly.) Use the other builders only if you have had at
least the equivalent of a course in introductory programming; they are powerful
but complex tools. </p>

<p>Cutting parts of the formula and pasting them to a different
place in the same or a different formula also helps reduce error, but be sure
to make any needed changes in the pasted section. </p>

<p>There are many more operations and functions, of course; you
can learn about them via good questions to the Assistant, or by using features
available under the Help menu. </p>

<p>&bull;  Change the text in the label box (for the formula-holding
field) to something meaningful (just click on the box and drag the mouse to
highlight the existing text and start typing). Resize the box as needed to hold
the text nicely (click on the box, move the cursor until it turns into a double
arrow, and then drag the edge of the box).</p>

<p>&bull; Save the form. Check that the new field is working properly by opening the data form
and comparing the computed result against the dialysis events and facilities
data you have (for each patient). Enter new data values as needed to insure
that the Current Dialysis Facility variable is being computed properly.</p>

<p>&bull;  Now, add the following calculated fields to your form.
Name them appropriately; display them nicely. (For instance, on the Yes/No
fields, you could display the words &#147;Yes&#148; or
&#147;No,&#148; as appropriate, or a check box that&#146;s marked
when the answer is &#147;Yes&#148;&#151;but don&#146;t put a 1
for Yes and a 2 for No; that&#146;s much too hard to decipher! Remember:
Presentation matters.)</p>

<p>Patient Alive? (As of today&#146;s date) &#147;Yes&#148; if so, &#147;No&#148; if not
<br>Current Mode: the event code of the most recent event (0 = no events)
<br> Ever aTransplant? &#147;Yes&#148; if the patient ever received a transplant,
&#147;No&#148; otherwise</p>

<p><i>Check your work carefully</i>: Remember the potential
consequences of wrong data!</p>

<div class="section">
<hr>
<h3>Part III: Summary Results and Report</h3>
</div>
<h4>Preparing a summary report</h4>

<p>Sifting through several
(actually, at the Networks, it&#146;s thousands) of data records to discern patterns
is tough, if not impossible. So we prepare <i>summary reports</i> where
the data for all or a group of records is combined in well-thought-out ways to
make evident the data&#146;s patterns and properties. A report has titles,
column headings, labeling, summary lines, and so forth as necessary to present
the data in the clearest, neatest way possible for a reader who might never
see, or care about, the data entry process. In Access, a report obtains its
data from tables or queries (more on the latter in a minute), and formats it by
commands that appear in the report itself. </p>

<p>A query is where computed information, based on fields
stored in the database&#146;s tables, is kept; the query often includes
totals and averages for a subgroup of records fulfilling specified criteria.
We&#146;ll lead you through a query that computes and stores a couple of
&#147;summary variables,&#148; and then use those variables in a
report.</p>

<p>&bull;  In the Database dialog box, click on <font class = "codeFaceSmall">Queries</font>
and click on <font class = "codeFaceSmall">Create a query in design view </font>and
then<font class = "codeFaceSmall"> Open </font>to create a blank query. Now
select your table name from the <font class = "codeFaceSmall">Show Table</font>
window, and click on <font class = "codeFaceSmall">Add</font>; this action
makes your table&#146;s fields available to the query. Now click on <font class = "codeFaceSmall">Close</font>. </p>

<p>You now have a blank query. To provide you an example of how
summary variables can be computed (as usual in Access, there is more than one
way to do this), we&#146;ll step you through creating a couple of
variables: 1) the number of females in the database, and 2) the number of male
patients who are currently on dialysis.</p>

<p>You&#146;ll note a table at the bottom of the query
screen; each column of the table stores information about one computed
variable. We will be using predefined Access functions, called
&#147;totals,&#148; for this work, so</p>

<p>&bull; Click <font class = "codeFaceSmall">Totals</font> under the <font class = "codeFaceSmall">View</font> menu so that a <font class = "codeFaceSmall">Total:</font> row is added to the query table.</p>

<p>We&#146;ll be working in the first column for the number of women.</p>

<p>&bull; In the <font class = "codeFaceSmall">Field:</font> box, enter the expression <font class = "codeFaceSmall">FemaleCount:Count(*)</font>. This tells the query
that you want to compute a new variable <font class = "codeFaceSmall">FemaleCount</font>
that is a count of records. </p>

<p>The <font class = "codeFaceSmall">Table</font>: box tells
the query the table in which the selected field resides (it&#146;s possible
that two tables each have a field with the same name). For this calculated
variable, leave <font class = "codeFaceSmall">Table:</font>
blank&#151;the variable is not part of any table.</p>

<p>&bull; Change the value in the <font class = "codeFaceSmall">Total:</font> box to <font class = "codeFaceSmall">Expression</font>. This indicates that <font class = "codeFaceSmall">FemaleCount</font>&#146;s will be based on a
subgroup (rather than all) of the records in the table. </p>

<p><font class = "codeFaceSmall">Show</font> being checked
means that, when the query is opened (executed), the result of this computation
will display (which is what we want).</p>

<p>Now we need to modify <font class = "codeFaceSmall">FemaleCount</font>
so it contains a count of women only; right now, it&#146;s a count of
everyone in the database. </p>

<p>&bull; In the next column (to the right), enter <font class = "codeFaceSmall">Gender</font>
in the <font class = "codeFaceSmall">Field:</font> box.</p>

<p>Access will fill in the table name (since it knows
that&#146;s the only place <font class = "codeFaceSmall">Gender</font>
can come from), check the<font class = "codeFaceSmall"> Show:</font> box, and
place <font class = "codeFaceSmall">Group By</font> in the <font class = "codeFaceSmall">Total</font> box</p>

<p>&bull; Change <font class = "codeFaceSmall">Group By</font> to <font class = "codeFaceSmall">Where</font>. Access will now select records &#147;where&#148;
certain criteria are met</p>

<p>Note that <font class = "codeFaceSmall">Show</font> has
been unchecked; selection fields, since they only help us set up the results
for other fields, are typically not displayed. </p>

<p>&bull; In the <font class = "codeFaceSmall">Criteria:</font> box, enter <font class = "codefacesmall">=F</font>. </p>

<p>This selects out the gender group that has a value equal to
F&#151;females&#151;and ignores all other groups. So, in this query,
any time a variable (like <font class = "codeFaceSmall">FemaleCount</font>)
is computed, the computation will include only those records where Gender is F.
Since <font class = "codeFaceSmall">FemaleCount</font> is a count, that count
will now only be of females.</p>

<p>&bull; Save the query; give it a meaningful name (we called it <font class = "codeFaceSmall">Number of Women</font>).</p>

<p>&bull; Now double-click <font class = "codeFaceSmall">Number of Women</font> in the </font><font class = "codeFaceSmall">Database</font>
window; if all has gone well, the (correct) count will appear in a
spreadsheet-like form in a window. </p>

<p>&bull;  As always, test your work: enter a number of different
records into the database (you can delete them later, if need be) so you can be
sure that <font class = "codeFaceSmall">FemaleCount</font> is correctly
counting female patients. Be particularly sure to check unusual situations (for
instance, try the case where the database has no records where <font class = "codeFaceSmall">Gender</font> equals F, and make sure <font class = "codeFaceSmall">FemaleCount</font> is 0 in that case).</p>

<p>Now we build a query to count
the number of male patients who are currently on dialysis. A look at the
codebook tells us that &#147;currently on dialysis&#148; means that the
patient&#146;s most recent mode is between 1 and 13. What&#146;s the
most recent event? It&#146;s the highest-numbered event that has a non-zero
code&#151;0 doesn&#146;t count as a mode change, since it means
&#147;not yet used.&#148; We check the most recent event to see if it is between 1 and 13. If so, the patient
is on dialysis. If the gender code for this patient indicates the patient is
male, then this patient is added to the count of male patients who are
currently on dialysis.</p>

<p>&bull;  Create a new query, via the design view</p>

<p>&bull; Create an expression <font class = "codeFaceSmall">CountMenCntDx:Count(*)</font>;
this new variable is just another (more complicated) count.</p>

<p>Unfortunately, Access does not allow one to use computed
results on forms (such as the current dialysis facility we computed above) in
queries. So, to select the records to appear in this count, we can&#146;t
use the current dialysis mode variable from the form: we have to compute a
similar variable here. </p>

<p>&bull; Create a logical expression that computes the current dialysis mode. Make its value
parallel the current dialysis form variable. (Hint: the expression begins <font class = "codeFaceSmall">CntDxMode: IIf([Event3] &lt;&gt; 0, [Event3],
IIf([Event2] &lt;&gt; 0, [Event2], ...</font> and ends with <font class = "codeFaceSmall">Event1</font> and a few closing parentheses.) Make
sure <font class = "codeFaceSmall">Table:</font> is blank (this expression is
certainly not in the table!), <font class = "codeFaceSmall">Show:</font> is
unchecked, and <font class = "codeFaceSmall">Total:</font> is <font class = "codeFaceSmall">Where</font>. </p>

<p>&bull; Set <font class = "codeFaceSmall">Criteria:</font> to <font class = "codeFaceSmall">&gt;0 And &lt; 14</font>.</p>

<p>&bull; Save
your query as <font class = "codeFaceSmall"># Males Now on Dx</font>.</p>

<p>Access will, when the query is opened, compute the current
mode for each patient, and select out those patients current mode is between 1
and 13. That&#146;s just the group we want to count.</p>

<p>&bull; Check your work!</p>

<p>We can create as many queries as we wish on the database,
and they can get pretty much as complicated as we want. (For instance, suppose
we wanted to count all the females currently on dialysis. We would have three
columns in the query: the count variable, a &#147;group by&#148; female
in the next column, and then another &#147;group by,&#148; for current
dialysis in the third. Access includes in a computed query variable only those
records that meet all the &#147;group by&#148; criteria.) Queries (and
thus their variables) can also be made available to other queries, so one can
build up complex queries a bit at a time, if desired.</p>

<p>&bull; Create the following summary variables (you&#146;ll note some are just the ones we
created above, or very similar to them):</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;# of people in database {No selection criteria}
<br>&nbsp;&nbsp;&nbsp;&nbsp;#of women in database {1 selection criterion}
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of men currently on dialysis {2 selection criteria}
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of men who are current transplants {2 selection criteria}
<p&nbsp;&nbsp;&nbsp;&nbsp;>Again, check your work! Be sure to save your results.</p>

<p>As you&#146;ve noticed, the query viewing is primitive,
and only allows you to look at the variables in that query. We want to present
a summary report that contains all our summary variables, and is in an
easy-to-read format.</p>

<p>Unfortunately, Access is very picky about the properties
that queries and tables must have in order for all of them to appear in the
same report. For instance, if you ask Access to create a report that uses
variables from the table itself, and from a query based on that table, it often
refuses! It also can give incorrect results when you try to use two (or more)
queries in a report that are based on the same table.</p>

<p>So, in order to get all the summary variables into one
report, we &#147;fake&#148; Access out (not really: we just follow its
rules to &#147;work around&#148; its limitations). The trick: copy all
the summary variables into one, new query, and then use that new query as the
basis of the report:</p>

<p>&bull; Create a new query, using the design view</p>

<p>&bull; In the <font class = "codeFaceSmall">Show Table</font> window, select the <font class = "codeFaceSmall">Queries</font> tab and, in turn, <font class = "codeFaceSmall">Add</font> every query which contains a variable you
want to appear on the report. Close the window when you&#146;re done. (If
you add a table you decide you don&#146;t need, right-click on it and
select <font class = "codeFaceSmall">Remove Table</font>. If you later want
to add a table, click on <font class = "codeFaceSmall">Show Table</font> in the <font class = "codeFaceSmall">Query</font> menu.</p>

<p>&bull; For each variable you want to appear in the report, click on a <font class = "codeFaceSmall">Field:</font> box and select that variable.
You&#146;ll note certain settings &#147;come along&#148; with this
selection; leave them be: they are just what we want.</p>

<p>&bull; Save your query as something like <font class = "codeFaceSmall">All Summary
Measures</font>.</p>

<p>&bull; Check your selections by opening (running) this query, and note if all the needed
variables are present. If so, save the query and exit; if not, go back into
design mode and fix things.</p>

<p>You&#146;re now ready to create the summary report.</p>

<p>&bull; In the <font class = "codeFaceSmall">Database</font> window, click on <font class = "codeFaceSmall">Reports</font> then on <font class = "codeFaceSmall">Create
report by using wizard</font>.</p>

<p>The Report Wizard will do a lot of the initial report
creation work for you; it&#146;s much faster than building a report from
the ground up.</p>

<p>&bull; Where you are asked for the table or query to use, select <font class = "codeFaceSmall">All Summary Measures</font>, then click on the right arrow to move each
of the variables from the query that you want in the report into the <font class = "codeFaceSmall">Selected Fields</font> area. (This screen does let
you choose variables from other queries and tables, but, if you do,
you&#146;ll probably just get error messages!)</p>

<p>&bull; Just click <font class = "codeFaceSmall">Next</font> on the following screen: sorting
orders makes no sense for summary variables. (Choosing a sorting order would
make sense if we were printing a value for each patient, instead of printing
one value summarizing all patients.)</p>

<p>&bull; Choose a layout and orientation that suits the intended audience; that is, they are not computer or Access experts; they are business types who uderstand dialysis reporting. Click <font class = "codeFaceSmall">Next</font>.
Choose a style that you think your audience will like; click <font class = "codeFaceSmall">Next</font>.
Give a title for your report and click <font class = "codeFaceSmall">Finish</font>.
A preview of the report will appear.</p>

<p>You now have a basic report. But it is a bare-bones report:
the titles of the variables, for instance, are not very meaningful to the
report&#146;s reader.
So, go into the design mode and spiff up the report:</p>

<p>&bull; In the <font class = "codeFaceSmall">Database</font> window , click the name of
your report and select <font class = "codeFaceSmall">Design</font>.</p>

<p>Access treats a layout as having sections. The <font class = "codeFaceSmall">Report Header</font> contains information that
appears once on the report, at the beginning. The <font class = "codeFaceSmall">Page Header</font> is information that appears at the top of each page.
The <font class = "codeFaceSmall">Detail</font> section is information that
is repeated for each &#147;entity&#148; that appears in the report.
(Since the variables appearing in this report are summarizing information
across all patients, they only appear once; right now, this report has one
entity). The <font class = "codeFaceSmall">Page Footer</font> controls
information that appears at the bottom of every page. The <font class = "codeFaceSmall">Report Footer</font> contains information that
appears once, at the end of the report.</p>

<p>&bull; Move the variables from the <font class = "codeFaceSmall">Detail</font> section to
the <font class = "codeFaceSmall">Report Footer</font> (just select and drag
them). </p>

<p>These variables and titles only appear once on this report,
so they should really be in the <font class = "codeFaceSmall">Report Footing</font>
section; it is misleading to leave them where they are.</p>

<p>&bull;  Make this report as easy to read and attractive as can be
managed inside Access. You can easily check how the report will look by
clicking <font class = "codeFaceSmall">Print</font> <font class = "codeFaceSmall">Preview</font> in the <font class = "codeFaceSmall">File</font> menu,
and then clicking it again to have the design view reappear. Try not to print
copy after copy of the report to check its appearance&#151;look at it on
the screen. That approach will be faster, save paper, and save you money.</p>

<p>The report format options found in the Toolbox are quite similar
to those used in form design. Try out various ideas; don&#146;t be afraid
to experiment. (Make a copy of your database. If your experiments go so awry
that you don&#146;t want to try to recover from them, just throw away your
current database and use the copy.) It&#146;s so easy to create a report
that you might make several versions of the report, trying out different
approaches; when you make the one you think is best, delete the others.</p>

<h4>A note about context</h4>

<p> In the introduction to this exercise, we
gave you quite a bit of information about the data&#146;s meaning. Yet, in
all the work you&#146;ve done, you didn&#146;t need to know what the
data meant&#151;all you had to do was follow the instructions of others of
what to do with it. This is a useful phenomenon, in that one doesn&#146;t
need to be an expert in a given field to do computer work for it.</font></p>

<p>So why did we bother with the
lengthy background? Because you do need to know about the data&#146;s
context and meaning if you wish to know if your results are reasonable;
it&#146;s often called a &#147;reality check.&#148; You need to
know the context of the data&#146;s use to devise a presentation
appropriate to your audience. Just because a database produces a result
doesn&#146;t mean it is correct or useful! </p>

<h4>A note about saving your database</h4>

<p>Access tries to figure out how big your database is
going to get and reserves space for it. Sometimes this approach makes the
database file quite large, even though there is little information in the
database itself. (This typically happens if you repeatedly add, then delete,
large amounts of information). If you find that your database doesn&#146;t
fit onto your diskette or memory stick, compact it: go to the <font class = "codeFaceSmall">Tools</font> menu, select <font class = "codeFaceSmall">Database
Utilities</font>, then, from its submenu, select <font class = "codeFaceSmall">Compact
and Repair Database</font>. That should do the trick. </p>

<p>If, after compaction, your database is still too big to fit
on your backup media (this is quite rare), back up your database to your <font class = "codeFaceSmall">H:</font> drive.<b></b></p>

<div class="section">
<hr>
<h3>Optional work</h3>
</div>

<p>This exercise&#146;s required work just scratches the surface of table, form
and report design and of Access&#146; features. You can add do much more;
some ideas follow. We encourage you to do other things instead of or in
addition to those suggested here&#151;but check with the TA first to make
sure what you have in mind is reasonable given Access&#146; capabilities
and the time you have to devote to bringing your idea to fruition.</p>

<p><i>Hint:</i> You&#146;ll
want to make extensive use of Access&#146; help facilities, and perhaps get
guidance from the TA, before undertaking most of these activities.</p>

<p>There are many more useful fields that can be computed for
patients (and are, in the actual database):</p>

<p>&bull;  Compute the patient&#146;s age, to the nearest year. The
age is the number of years from birth to today, if the patient is alive, or
birth to death, if the patient is deceased. If the birth or death year is
missing, set the age to 999. If the birth or death month is missing, assume a
month of 06; if the birth or death day is missing, assume 15. (These are
standard assumptions; previous research has shown them to be
reasonable.)</p>

<p>The easiest way to proceed here is to look at the Patient
Alive? field. If it is &#147;Yes&#148;, use an &#147;ending
date&#148; of today&#146;s date. If not, use the date of death as the
ending date. Using the month and day assumptions above as needed, make
beginning (birth) and ending (death or today&#146;s) dates and, using date
arithmetic, compute the difference between the two days. Divide the result by
365.25 (the number of days in a year, on average), and round to the nearest
year. If the calculation can&#146;t be done, store a value of 777. You will
probably need some temporary fields, and perhaps another function or two, to
complete the calculation. (Exactly what will be needed depends on exactly how
you do the computation; there are several approaches that work.) This
calculation will probably require a bit of thought to get right. Do use
Access&#146; information tools discussed above to discover how to do the
necessary calculations.</p>

<p>&bull;  Compute &#147;Current Transplant?&#148; The field
contains &#147;Yes&#148; if the patient&#146;s most recent dialysis event
was a transplant, &#147;No&#148; otherwise. </p>

<p>&bull;  Compute the patient&#146;s age at the first event,
rounded to the nearest year. </p>

<p>&bull;  Compute the patient&#146;s years on dialysis, which is
the time from first event until today, if the patient is alive, or to death.
Use the same rules regarding missing data as we used for the patient&#146;s
age. (If you computed the patient&#146;s age properly, all you need to do
is change a date or two in the computation to get these fields&#146;
values.)</p>

<p>&bull;  Compute &#147;grouped versions&#148; of the
previous two fields, as follows:</p>

<font class = "codeFaceSmall">
<p>&nbsp;&nbsp;&nbsp;&nbsp;If the field&#146;s value is between 0 and 19, make the grouped
version&#146;s value a 1;
<br>&nbsp;&nbsp;&nbsp;&nbsp;If it is between 20 and 40, make the grouped value a 2;
<br>&nbsp;&nbsp;&nbsp;&nbsp;If between 41 and 60, make it a 3;
<br>&nbsp;&nbsp;&nbsp;&nbsp;If 61 or greater, make it a 4;
<br>&nbsp;&nbsp;&nbsp;&nbsp;If can&#146;t be calculated (999), make it a 9.</p>
</font>

<p>Add them to the layout; label, format and position them well.</p>

<p>&bull; Add one or more of these following summary fields to
your report. Note you may have to create some of the computed fields discussed above. The new fields are</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;# of people in age group 1
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of people in age group 2
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of people in age group 3
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of people in age group 4</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;# of women in age group 1
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of women in age group 2
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of women in age group 3
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of women in age group 4</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;# of men in age group 1
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of men in age group 2
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of men in age group 3
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of men in age group 4</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;# of dx patients in age group 1
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of dx patients in age group 2
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of dx patients in age group 3
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of dx patients in age group 4</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;# of current tx patients in age group 1
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of current tx patients in age group 2
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of current tx patients in age group 3
<br>&nbsp;&nbsp;&nbsp;&nbsp;# of current tx patients in age group 4</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;#of patients whose first event occurred when they were in age group 1
<br>&nbsp;&nbsp;&nbsp;&nbsp;#of patients whose first event occurred when they were in age group 2
<br>&nbsp;&nbsp;&nbsp;&nbsp;#of patients whose first event occurred when they were in age group 3
<br>&nbsp;&nbsp;&nbsp;&nbsp;#of patients whose first event occurred when they were in age group 4</p>

<p>Another common database activity is to pull out selected
records and/or fields and send them to another site (as the Networks do,
sending their data to CMS).</p>

<p>Let&#146;s assume you are sending a copy of the database to a researcher. </p>

<p>&bull;  Make a copy of your database. Remove from it the facility
fields (this researcher doesn&#146;t care about them); also remove the
summary fields and reports (these don&#146;t transfer to a different
database well, since they are not really part of the patient table). Save the
revised database with the name <font class = "codeFaceSmall">
For Dr Spock</font>, as a tab delimited text file. Turn it in electronically with
your other work.</p>

<p>There is much more that can be
learned from this data. Further summary statistics can be computed, both grand
and by group, and using fields we haven&#146;t employed; research questions
can be investigated. Data can be graphed and charted, making it even easier to
see patterns in it. Data can be copied to other tools within Office and
analyzed or processed there (for instance, copying data to a spreadsheet lets
you use statistics not available in Access.) Or pictures and
other data can be copied from elsewhere in Office and copied into your database
layouts to &#147;spiff them up.&#148;</p>

<p>And there are many other areas of
inquiry; here are some you might consider: </p>

<p>Do patients who have ever had a
transplant live longer than patients who have never had one? (If not, then
maybe the government shouldn&#146;t fund transplants&#151;but perhaps
it&#146;s more subtle than this...)</p>

<p>Are there differences in longevity
based on when ESRD began (for instance, do youngsters who start on ESRD live as
long as elders who do)? </p>

<p>How long does a typical
transplanted kidney function?</p>

<p>How long does a patient typically
stay on CAPD? To what mode do they go when they change?</p>

<p>Which facilities have the highest
fatality rate? Transplant failure rate? Leaving-CAPD rate?</p>

<p>Are there major differences in any
of these findings because of demographic factors (e.g., age, gender,
ethnicity)?</p>

<p>So, if you&#146;d like, &#147;massage the
data&#148; further. You&#146;ll need to think carefully about what
questions you want to try to answer, and how best to go about analyzing the
data to do so.</p>

<p>Your grade for this part of the
assignment will depend one how much additional work you undertake, how well you
do it, and how complicated it is to execute. Remember, though, you cannot get
optional credit unless you have completed the required parts of this
assignment; we want you to focus on the required material first. </p>

<font face="Helvetica" size=1>
<p>Written by
Norman Jacobson, December 1995; inspired by his work for ESRD Network #18
<br>Rewritten by
Norman Jacobson (to change some tasks and split into smaller exercises), December 1996
<br>Rewritten for Windows NT, Microsoft Access and ICS 1A by Norman Jacobson, September 1997
<br>Revised by Norman Jacobson, April 1998
<br>Revised by Norman Jacobson, September 1998
<br>Minor revisions by Norman Jacobson, August 1999<
<br>Revised for ICS10A by Norman Jacobson, December 2000<
<br>Revised for the Winter 2005 offering of ICS10A, including updating to reflect Access 2003, by
Norman Jacobson, December 2004
<br>Minor revisions and some polishing for ICS10A Spring 2006 by Norman Jacobson, March and April 2006</p>

</font>

</body>
</html>

