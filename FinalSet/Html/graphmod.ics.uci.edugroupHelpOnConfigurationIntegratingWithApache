<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="robots" content="index,nofollow">

<title>HelpOnConfiguration/IntegratingWithApache - GraphModAlg@UCI</title>
<script type="text/javascript" src="/moin_static163/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static163/rightsidebar/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="/moin_static163/rightsidebar/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="/moin_static163/rightsidebar/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="/moin_static163/rightsidebar/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static163/rightsidebar/css/msie.css">
<![endif]-->


<link rel="alternate" title="GraphModAlg@UCI: HelpOnConfiguration/IntegratingWithApache" href="/group/action/rss_rc/HelpOnConfiguration/IntegratingWithApache?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=HelpOnConfiguration%2FIntegratingWithApache&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="/group/Main_Page">
<link rel="Alternate" title="Wiki Markup" href="/group/HelpOnConfiguration/IntegratingWithApache?action=raw">
<link rel="Alternate" media="print" title="Print View" href="/group/HelpOnConfiguration/IntegratingWithApache?action=print">
<link rel="Up" href="/group/HelpOnConfiguration">
<link rel="Search" href="/group/FindPage">
<link rel="Index" href="/group/TitleIndex">
<link rel="Glossary" href="/group/WordIndex">
<link rel="Help" href="/group/HelpOnFormatting">
</head>

<body  lang="en" dir="ltr">

<div id="header">

<form id="searchform" method="get" action="/group/HelpOnConfiguration/IntegratingWithApache">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<div id="logo"><a href="/group/Main_Page"><img src="/moin_static163/common/moinmoin.png" alt="MoinMoin Logo"></a></div>
<div id="locationline">


<ul id="pagelocation">
<li><a href="/group/HelpOnConfiguration">HelpOnConfiguration</a></li><li><a class="backlink" href="/group/action/fullsearch/HelpOnConfiguration/IntegratingWithApache?action=fullsearch&amp;context=180&amp;value=linkto%3A%22HelpOnConfiguration%2FIntegratingWithApache%22" rel="nofollow" title="Click to do a full-text search for this title">IntegratingWithApache</a></li>
</ul>

</div>

</div>

<div id="sidebar">
<div class="sidepanel">
<h1>Wiki</h1>

<ul id="navibar">
<li class="wikilink"><a href="/group/Main_Page">Main_Page</a></li><li class="wikilink"><a href="/group/RecentChanges">RecentChanges</a></li><li class="wikilink"><a href="/group/FindPage">FindPage</a></li><li class="wikilink"><a href="/group/HelpContents">HelpContents</a></li><li class="current"><a href="/group/HelpOnConfiguration/IntegratingWithApache">IntegratingWithApache</a></li>
</ul>

</div>
<div class="sidepanel">
<h1>Page</h1>
<ul class="editbar"><li><span class="disabled">Immutable Page</span></li><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbinfo" href="/group/action/info/HelpOnConfiguration/IntegratingWithApache?action=info" rel="nofollow">Info</a></li><li><a class="nbattachments" href="/group/action/AttachFile/HelpOnConfiguration/IntegratingWithApache?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="/group/HelpOnConfiguration/IntegratingWithApache">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="raw">Raw Text</option>
<option value="print">Print View</option>
<option value="RenderAsDocbook">Render as Docbook</option>
<option value="refresh">Delete Cache</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="SpellCheck">Check Spelling</option>
<option value="LikePages">Like Pages</option>
<option value="LocalSiteMap">Local Site Map</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Subscribe User</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
<option value="PackagePages">Package Pages</option>
<option value="SyncPages">Sync Pages</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="Load">Load</option>
<option value="Save">Save</option>
<option value="SlideShow">SlideShow</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>
<div class="sidepanel">
<h1>User</h1>
<ul id="username"><li><a href="/group/action/login/HelpOnConfiguration/IntegratingWithApache?action=login" id="login" rel="nofollow">Login</a></li></ul>
</div>
</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><p class="line867"><strong> How to integrate your wiki with existing Apache setup </strong> <span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><p class="line862">There are currently 5 possibilities running a <a href="/group/MoinMoin">MoinMoin</a> wiki: Using CGI, FastCGI, Mod Python, Standalone server or Twisted server. The most advanced options are FastCGI, whose license is restricted, and Mod Python, which needs a lot RAM. FastCGI and Mod Python are not available on all platforms and are known to have configuration issues. The next solution is running Twisted or Standalone servers, which are much faster than CGI and easier to configure.  <span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><p class="line862">However, many people already run web servers and serve static pages or other applications, and want to add a wiki to the current setup. For them, the best option is to run <a href="/group/MoinMoin">MoinMoin</a> as a Standalone or Twisted server proxied behind your existing Apache web server. This works out of the box with simple setup. <span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><p class="line862">In the example setup below, we will integrate a <a href="/group/MoinMoin">MoinMoin</a> wiki in our site <a class="http" href="http://www.example.com/exwiki/">http://www.example.com/exwiki/</a>. <span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><p class="line867"><div class="table-of-contents"><p class="table-of-contents-heading">Contents<ol><li>
<a href="#Requirements">Requirements</a></li><li>
<a href="#Integrating_with_Apache_2">Integrating with Apache 2</a><ol><li>
<a href="#Standalone_or_Twisted_setup">Standalone or Twisted setup</a></li><li>
<a href="#Apache_2_setup">Apache 2 setup</a></li></ol></li><li>
<a href="#Integrating_with_Apache_1">Integrating with Apache 1</a><ol><li>
<a href="#Standalone_or_Twisted_setup-1">Standalone or Twisted setup</a></li><li>
<a href="#Apache_1_setup">Apache 1 setup</a></li></ol></li><li>
<a href="#Farm_configuration">Farm configuration</a></li><li>
<a href="#Disabling_host_rewriting">Disabling host rewriting</a></li></ol></div> <span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><p class="line867">
<h1 id="Requirements">Requirements</h1>
<span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><ol type="1"><li>Existing installation of Apache 1 or Apache 2 web server <span class="anchor" id="line-23"></span></li><li><p class="line862">Existing installation of Standalone or Twisted server as explained in <a href="/group/HelpOnInstalling">HelpOnInstalling</a>. <span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span></li></ol><p class="line867">
<h1 id="Integrating_with_Apache_2">Integrating with Apache 2</h1>
<span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><p class="line867">
<h2 id="Standalone_or_Twisted_setup">Standalone or Twisted setup</h2>
<span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><p class="line862">If you want to use Twisted, edit <tt>mointwisted.py</tt> and set these options: <span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><pre><span class="anchor" id="line-1"></span>    port = 8000
<span class="anchor" id="line-2"></span>    interfaces = ['localhost']</pre><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><p class="line862">If you want to use Standalone, edit <tt>standalone.py</tt> and set these options: <span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><pre><span class="anchor" id="line-1-1"></span>    port = 8000
<span class="anchor" id="line-2-1"></span>    interface = 'localhost'</pre><span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><p class="line862">Now run your moin server and check that it works at <a class="http" href="http://localhost:8000">http://localhost:8000</a>. <span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><p class="line867">
<h2 id="Apache_2_setup">Apache 2 setup</h2>
<span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><p class="line874">This setup requires mod_proxy and mod_headers. Make sure they are installed and loaded before you continue. <span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><p class="line862">Edit your Apache configuration file, either <tt class="backtick">httpd.conf</tt> or an included configuration file: <span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><pre><span class="anchor" id="line-1-2"></span># Can be off for reverse proxying, more secure
<span class="anchor" id="line-2-2"></span>ProxyRequests Off
<span class="anchor" id="line-3"></span>
<span class="anchor" id="line-4"></span>Alias /moin_static160/ "/usr/share/moin/htdocs/"
<span class="anchor" id="line-5"></span>
<span class="anchor" id="line-6"></span>&lt;Location /exwiki/&gt;
<span class="anchor" id="line-7"></span>    ProxyPass http://localhost:8000/
<span class="anchor" id="line-8"></span>    ProxyPassReverse http://localhost:8000/
<span class="anchor" id="line-9"></span>    RequestHeader set X-Moin-Location /exwiki/
<span class="anchor" id="line-10"></span>&lt;/Location&gt;</pre><span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><p class="line862">Now restart Apache and test your wiki at <a class="http" href="http://localhost/exwiki/">http://localhost/exwiki/</a> or <a class="http" href="http://www.example.com/exwiki/">http://www.example.com/exwiki/</a> <span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><p class="line874">This setup was tested on Mac OS X. <span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><p class="line874">On Debian Sarge, the default Apache configuration denies all proxy access, so at least the following should be added: <span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><pre><span class="anchor" id="line-1-3"></span>&lt;Proxy http://localhost:8080/&gt;
<span class="anchor" id="line-2-3"></span>  Order deny, allow
<span class="anchor" id="line-3-1"></span>  Allow from all
<span class="anchor" id="line-4-1"></span>&lt;/Proxy&gt;</pre><span class="anchor" id="line-72"></span><span class="anchor" id="line-73"></span><ul><li style="list-style-type:none"><p class="line891"><img alt="/!\" height="15" src="/moin_static163/rightsidebar/img/alert.png" title="/!\" width="15" /> If you ever change the value of the <tt class="backtick">X-Moin-Location</tt> header, you may have to manually delete cached data for the change to show up in wiki pages. See <a class="interwiki" href="http://moinmoin.wikiwikiweb.de/MoinMoinBugs/SiteLocationIgnoredOnEditPage" title="MoinMoin">MoinMoinBugs/SiteLocationIgnoredOnEditPage</a> for details. <span class="anchor" id="line-74"></span><span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span></li></ul><p class="line867">
<h1 id="Integrating_with_Apache_1">Integrating with Apache 1</h1>
<span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span><p class="line867">
<h2 id="Standalone_or_Twisted_setup-1">Standalone or Twisted setup</h2>
<span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span><p class="line862">If you want to use Twisted, edit <tt>mointwisted.py</tt> and set these options: <span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><pre><span class="anchor" id="line-1-4"></span>    properties = {'script_name': '/mywiki', 'http_host': 'yourdomain'}
<span class="anchor" id="line-2-4"></span>    port = 8000
<span class="anchor" id="line-3-2"></span>    interfaces = ['localhost']</pre><span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span><p class="line862">If you want to use Standalone, edit <tt>standalone.py</tt> and set these options: <span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><pre><span class="anchor" id="line-1-5"></span>    properties = {'script_name': '/mywiki', 'http_host': 'yourdomain'}
<span class="anchor" id="line-2-5"></span>    port = 8000
<span class="anchor" id="line-3-3"></span>    interface = 'localhost'</pre><span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><ul><li style="list-style-type:none"><p class="line891"><img alt="(!)" height="15" src="/moin_static163/rightsidebar/img/idea.png" title="(!)" width="15" /> Another solution may be to use url_mapping config option. <span class="anchor" id="line-95"></span><span class="anchor" id="line-96"></span></li></ul><p class="line867">
<h2 id="Apache_1_setup">Apache 1 setup</h2>
<span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span><p class="line874">This setup requires mod_proxy. Make sure it's installed and loaded before you continue. <span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span><p class="line862">Edit your Apache configuration file, either <tt class="backtick">httpd.conf</tt> or an included configuration file: <span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><span class="anchor" id="line-103"></span><span class="anchor" id="line-104"></span><span class="anchor" id="line-105"></span><span class="anchor" id="line-106"></span><span class="anchor" id="line-107"></span><span class="anchor" id="line-108"></span><span class="anchor" id="line-109"></span><span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span><pre><span class="anchor" id="line-1-6"></span># Can be off for reverse proxying, more secure
<span class="anchor" id="line-2-6"></span>ProxyRequests Off
<span class="anchor" id="line-3-4"></span>
<span class="anchor" id="line-4-2"></span>Alias /moin_static160/ "/usr/share/moin/htdocs/"
<span class="anchor" id="line-5-1"></span>
<span class="anchor" id="line-6-1"></span>&lt;Location /exwiki&gt;
<span class="anchor" id="line-7-1"></span>    ProxyPass http://localhost:8000/
<span class="anchor" id="line-8-1"></span>    ProxyPassReverse http://localhost:8000/
<span class="anchor" id="line-9-1"></span>&lt;/Location&gt;</pre><span class="anchor" id="line-112"></span><span class="anchor" id="line-113"></span><p class="line862">Now restart Apache and test your wiki at <a class="http" href="http://www.example.com/exwiki/">http://www.example.com/exwiki/</a> <span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span><ul><li style="list-style-type:none"><p class="line891"><img alt="(!)" height="15" src="/moin_static163/rightsidebar/img/idea.png" title="(!)" width="15" /> Note that your wiki will not work correctly from <a class="http" href="http://localhost:8000">http://localhost:8000</a> with this setup. <span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span><p class="line891"><img alt="&lt;!&gt;" height="15" src="/moin_static163/rightsidebar/img/attention.png" title="&lt;!&gt;" width="15" /> Tested with Apache 2, should work also on Apache 1. <span class="anchor" id="line-118"></span><span class="anchor" id="line-119"></span></li></ul><p class="line867">
<h1 id="Farm_configuration">Farm configuration</h1>
<span class="anchor" id="line-120"></span><span class="anchor" id="line-121"></span><p class="line862">When running Twisted or Standalone without a proxy, the wiki url contain the server name (and sometimes also the port) and the page name. For example: <tt class="backtick">localhost:8000/pagename</tt>.  <span class="anchor" id="line-122"></span><span class="anchor" id="line-123"></span><p class="line862">However, when running behind a proxy, the wiki url contain the proxy host, not the server name, and may include a "script_name". In this case, the wiki that run on <tt class="backtick">localhost:8000</tt> might have a url of <tt class="backtick">www.example.com/exwiki/pagename</tt> when you access it through the proxy, and <tt class="backtick">localhost:8000/pagename</tt> when you access it locally. <span class="anchor" id="line-124"></span><span class="anchor" id="line-125"></span><p class="line862">If you want to use same configuration file for both local and world access, use settings like this in your <tt class="backtick">farmconfig.py</tt>: <span class="anchor" id="line-126"></span><span class="anchor" id="line-127"></span><span class="anchor" id="line-128"></span><pre><span class="anchor" id="line-1-7"></span>wikis = [('exwiki', r'^(localhost:8000|www.example.com/exwiki).*')]</pre><span class="anchor" id="line-129"></span><span class="anchor" id="line-130"></span><p class="line874">If you want to have different configuration for local and world access: <span class="anchor" id="line-131"></span><span class="anchor" id="line-132"></span><span class="anchor" id="line-133"></span><span class="anchor" id="line-134"></span><pre><span class="anchor" id="line-1-8"></span>wikis = [('exwiki_local', r'^localhost:8000.*'),
<span class="anchor" id="line-2-7"></span>         ('exwiki_world', r'^www.example.com/exwiki.*'),]</pre><span class="anchor" id="line-135"></span><span class="anchor" id="line-136"></span><p class="line867">
<h1 id="Disabling_host_rewriting">Disabling host rewriting</h1>
<span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span><p class="line862">If you want to disable the new transparent host rewriting, override <tt class="backtick">http_host</tt> in your server script: <span class="anchor" id="line-139"></span><span class="anchor" id="line-140"></span><span class="anchor" id="line-141"></span><pre><span class="anchor" id="line-1-9"></span>    properties = {'http_host': 'hostname'}</pre><span class="anchor" id="line-142"></span><span class="anchor" id="bottom"></span></div>
<div id="pagebottom"></div>
</div>


<div id="footer">
<ul id="credits">
<li><a href="http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
</body>
</html>


