

<html>
	<head>
		<title></title>

		<meta NAME="GENERATOR" Content="Microsoft Visual Studio 6.0">
		<link REL="STYLESHEET" HREF="browse.css" TYPE="text/css">
		<script language=vbscript>
			dim root
		</script>
	</head>
	<body BGCOLOR=#ffffff>
	
	<table BGCOLOR=#7A97DD cellpadding="2" cellspacing="0" border="0" width="100%">
		<tr>
			<td width="59%">
				<table>
					<tr>
						<td class="viewspeaker" width="98%" align="left">
							<label class=speaker id="lblSpeaker"></label><br>
						</td>
					</tr>
					<tr>
						<td class="viewtitle" align="left">
							<label class=title id="lblTitle"></label>
						</td>
					</tr>
				</table>
		
			</td>
			<td align="right" width="24%">
				&nbsp;</td>
			<td align="left" width="13%">
				<img src="logo.jpg" WIDTH="184" HEIGHT="66">
			</td>
		</tr>
		</table>
			<hr>
	<table BGCOLOR=#ffffff cellpadding="0" cellspacing="0" width="100%" border="0">
		<tr>
			<td valign="top" width = "607" align="center" >
			<p>
									&nbsp;</p>
			<p>
									<OBJECT id=NSPlay0 width=320 height=300 codebase="../../../../wmp7.exe#Version=7,0,0,1956" classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6"  VIEWASTEXT>
										<PARAM NAME="URL" VALUE="">
										<PARAM NAME="rate" VALUE="1">
										<PARAM NAME="balance" VALUE="0">
										<PARAM NAME="currentPosition" VALUE="0">
										<PARAM NAME="defaultFrame" VALUE="">
										<PARAM NAME="playCount" VALUE="1">
										<PARAM NAME="autoStart" VALUE="-1">
										<PARAM NAME="currentMarker" VALUE="0">
										<PARAM NAME="invokeURLs" VALUE="0">
										<PARAM NAME="baseURL" VALUE="">
										<PARAM NAME="volume" VALUE="50">
										<PARAM NAME="mute" VALUE="0">
										<PARAM NAME="uiMode" VALUE="full">
										<PARAM NAME="stretchToFit" VALUE="0">
										<PARAM NAME="windowlessVideo" VALUE="0">
										<PARAM NAME="enabled" VALUE="-1">
										<PARAM NAME="enableContextMenu" VALUE="-1">
										<PARAM NAME="fullScreen" VALUE="0">
										<PARAM NAME="SAMIStyle" VALUE="">
										<PARAM NAME="SAMILang" VALUE="">
										<PARAM NAME="SAMIFilename" VALUE="">
										<PARAM NAME="captioningID" VALUE="">
									</OBJECT>
						</p>
						<p>
									<input type="checkbox" name="chkfullscreen" checked = true value="ON"><font color="#000000">Check 
									for full screen during demos</font></td>
				<td align="center" valign="top" height="520" width="61%">
					<div style="WIDTH: 340px;">
						<p>&nbsp;</p>
						<p><!-- ********************************************* --><!-- ********************************************* --><!-- ********************************************* -->
						
									<OBJECT id=NSPlay width=540 height=405 codebase="../../../../wmp7.exe#Version=7,0,0,1956" classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6"  VIEWASTEXT>
										<PARAM NAME="URL" VALUE="">
										<PARAM NAME="rate" VALUE="1">
										<PARAM NAME="balance" VALUE="0">
										<PARAM NAME="currentPosition" VALUE="0">
										<PARAM NAME="defaultFrame" VALUE="">
										<PARAM NAME="playCount" VALUE="1">
										<PARAM NAME="autoStart" VALUE="-1">
										<PARAM NAME="currentMarker" VALUE="0">
										<PARAM NAME="invokeURLs" VALUE="0">
										<PARAM NAME="baseURL" VALUE="">
										<PARAM NAME="volume" VALUE="0">
										<PARAM NAME="mute" VALUE="0">
										<PARAM NAME="uiMode" VALUE="none">
										<PARAM NAME="stretchToFit" VALUE="0">
										<PARAM NAME="windowlessVideo" VALUE="0">
										<PARAM NAME="enabled" VALUE="-1">
										<PARAM NAME="enableContextMenu" VALUE="-1">
										<PARAM NAME="fullScreen" VALUE="0">
										<PARAM NAME="SAMIStyle" VALUE="">
										<PARAM NAME="SAMILang" VALUE="">
										<PARAM NAME="SAMIFilename" VALUE="">
										<PARAM NAME="captioningID" VALUE="">
										<param name="enableErrorDialogs" value="0">
									</OBJECT>
					</div>				
				</td>
			</tr>
			<tr><td colspan="2">&nbsp;<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p>&nbsp;</p>
				<p><br><BR>
							<textarea readonly class=detailData id="lblAbstract" name="lblAbstract" style="position:relative;left:10;background-color:black;scrollbar-face-color:B6A58E;border:0;height:433;width:540;filter:progid:DXImageTransform.Microsoft.Shadow(direction=120,color=black,strength=5) progid:DXImageTransform.Microsoft.Alpha(opacity=60);padding:10" rows="1" cols="20"></textarea></p>
				<p><textarea readonly class=detailData id="lblBio" name="lblBio" style="position:relative;left:10;background-color:black;scrollbar-face-color:B6A58E;border:0;height:433;width:540;filter:progid:DXImageTransform.Microsoft.Shadow(direction=120,color=black,strength=5) progid:DXImageTransform.Microsoft.Alpha(opacity=60);padding:10" rows="1" cols="20"></textarea></p>
				<div class="bioDisp" id="bioDisp" style="DISPLAY: none; WIDTH: 93px; HEIGHT: 95px;">
							<br><br>&nbsp;</div>
						
							<div align=center class="slideDisp" id="slideDisp" style="DISPLAY: none; WIDTH: 540px; HEIGHT: 433px;">
								<br>
											
												&nbsp;</div>
						
						<div align="center" class="abstractDisp" id="abstractDisp" style="DISPLAY: none; WIDTH: 540px; HEIGHT: 433px;"> 
							<br><br>&nbsp;</div>
				<p><BR><BR><BR></td></tr>
	</table>		
	<xml id="xmldoc"></xml>
	<script language=vbscript>
	</script>
	</body>
	<script language="vbscript">
		dim screenXML
		sub xmldoc_onreadystatechange()
			readystate=xmldoc.readystate
			if readystate=4 then
				set root = xmldoc.documentElement
				'fullscreen mod
				set screenXML = root.selectNodes("//ScriptCommand[@Type=""SCREEN""]")
				'
				
				'nsplay.URL="mms://msrn/" & root.getAttribute("id") & "/asf/" & root.getAttribute("id") & ".asf"
				nsplay.URL="ASF/data.wmv"

				nsplay0.URL="ASF/video.wmv"
				lblspeaker.innerhtml=root.selectsinglenode("details").selectsinglenode("speaker").text
				lblTitle.innerhtml=root.selectsinglenode("details").selectsinglenode("title").text
				lblAbstract.innertext=root.selectsinglenode("details").selectsinglenode("abstract").text
				lblBio.innertext=root.selectsinglenode("details").selectsinglenode("bio").text
				'fulscreen mod
				ScreenScriptHandler
				'
				
				'are there slides? ask the xml
				if cbool(root.selectsinglenode("details").selectsinglenode("slides").getAttribute("exist")) then
					slideComponent.initializeSlides
				else
					document.all.slides.style.color="gray"
				end if
				if isEmpty(root.selectsinglenode("details").selectsinglenode("abstract").text) then
					document.all.abstract.style.color="gray"
				end if
				if isEmpty(root.selectsinglenode("details").selectsinglenode("bio").text) then
					document.all.biography.style.color="gray"
				end if
			
				if document.all.slides.style.color <> "gray" then
					slides_onclick
				else
					if document.all.abstract.style.color <> "gray" then
						abstract_onclick
					else
						if document.all.bio.style.color <> "gray" then
							biography_onclick
						end if
					end if
				end if
			end if
		end sub
		function isEmpty(sString)
			if len(trim(sString)) then
				for i = 1 to len(trim(sString))
					if asc(mid(sString,i,1)) > 31 then
						isEmpty=false
						exit function
					end if
				next
				isEmpty=true
			else
				isEmpty=false
			end if
		end function
		sub NSPlay_scriptCommand(param,value)
			on error resume next
			select case lcase(param)
				case "url"
					'slideComponent.fromScriptCommand(value)
			end select
		end sub
		sub NSPlay0_positionChange(oldPosition, newPosition)
			
			nsplay.controls.currentPosition = newPosition
			getScreenState4Time int(newPosition)
		end sub

		'****************************************************
		'****************************************************
		'****************************************************

		sub slides_onclick()
			if document.all.slides.style.color<>"gray" then
				if document.all.slides.style.textdecoration="underline" then
					clearall
				else
					clearall
					document.all.slides.style.textdecoration="underline"
					document.all.slideDisp.style.display=""
				end if
			end if
		end sub
		sub abstract_onclick()
			if document.all.abstract.style.color<>"gray" then
				if window.event.srcElement.style.textdecoration="underline" then
					clearall
				else
					clearall
					document.all.abstract.style.textdecoration="underline"
					document.all.abstractDisp.style.display=""
				end if
			end if
		end sub
		sub biography_onclick()
			if document.all.biography.style.color<>"gray" then
				if window.event.srcElement.style.textdecoration="underline" then
					clearall
				else
					clearall
					document.all.biography.style.textdecoration="underline"
					document.all.bioDisp.style.display=""
				end if
			end if
		end sub
		sub details_onclick()
			if window.event.srcElement.style.textdecoration="underline" then
				clearall
			else
				clearall
				document.all.details.style.textdecoration="underline"
				document.all.detailsDisp.style.display=""
			end if
		end sub
		sub chatHead_onclick()
			if window.event.srcElement.style.textdecoration="underline" then
				clearall
			else
				clearall
				document.all.chatHead.style.textdecoration="underline"
				document.all.chatDisp.style.display=""
			end if
		end sub
		sub clearall()
			on error resume next
			document.all.slides.style.textdecoration="none"
			document.all.slideDisp.style.display="none"
			document.all.allSlides.style.textdecoration="none"
			document.all.allSlideDisp.style.display="none"
			document.all.abstract.style.textdecoration="none"
			document.all.abstractDisp.style.display="none"
			document.all.biography.style.textdecoration="none"
			document.all.bioDisp.style.display="none"
			document.all.details.style.textdecoration="none"
			document.all.detailsDisp.style.display="none"
			document.all.ChatHead.style.textdecoration="none"
			document.all.ChatDisp.style.display="none"
			err.clear
		end sub
		on error resume next
			A=nsplay.versionInfo
			if err then
				 if msgbox("Do you wish to update to the latest version of Windows Player?" & chr(13) & "This will be required to view the Lecture." & chr(13) & "Installation will require a re-boot.",324,"MSRN")=6 then
					top.location.href="http://www.microsoft.com/windows/windowsmedia/download/AllDownloads.aspx?displang=en&qstechnology="
				 else
					top.location.href="blank.htm"
				 end if
			end if
		sub window_onload()
			'baseURL="http://Slides/"
			xmldoc.async=true
			xmldoc.load "ChronXML.xml"
			'xmldoc.load "chronxml.asp?id=8101"
		end sub 
		sub test
			nsplay.controls.fastForward
		end sub
		sub NSPlay0_PlayStateChange(iNewState)
			select case iNewState
			
				case 3
				nsplay.controls.play
				case 2
				nsplay.controls.pause
				case 1
				nsplay.controls.stop
			end select
			
		end sub
		
'********************************************
'    Special Code

		sub ScreenScriptHandler()
			on error resume next
			err.clear
			if chkfullscreen.checked then
				select case getScreenState4Time(nsplay.Controls.currentPosition)
					case "NORM"
						if nsplay.fullScreen then
							nsplay.fullScreen = false
						end if
					case "FULL"
						if not nsplay.fullScreen then
							nsplay.fullScreen = true
						end if
				 end select
			end if
			window.setTimeout "ScreenScriptHandler",1000
		end sub
		
		function getScreenState4Time(tIndex) 
			screenScriptIndex = FindCorrectScreenIndex(tIndex)
			if screenScriptIndex=(-1) then ' Screen should be in normal mode
				getScreenState4Time = "NORM"
				exit function
			else
				getScreenState4Time = screenXML.item(screenScriptIndex).getAttribute("Value")
			end if
		end function
		function FindCorrectScreenIndex(tIndex)
			i=0
			do until cbool(cInt(screenXML.item(i).getAttribute("Time")) > Cint(tIndex))
				if i=screenXML.length-1 then
					FindCorrectScreenIndex=i
					exit function
				end if
				i=i+1
			loop 
			FindCorrectScreenIndex=(i-1)
		end function
		
		sub nsplay_KeyPress(iKey)
			if nsplay.fullScreen then
				chkfullscreen.checked=false
				nsplay.fullScreen = false
			end if
		end sub
	
	
	</script>
</html>
