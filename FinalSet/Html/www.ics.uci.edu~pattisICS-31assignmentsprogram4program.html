<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
  <title>Program 4</title>
</head>

<body BGCOLOR="white">

<center>
<h1>Program 4</h1>
<h1>Functions and Control Structures</h1>
<p>
<h2>ICS-31: Introduction to Programming
</h2>
<p>
</center>


<!-- Introduction -->

<a name="Introduction">
<hr align="left" width="33%">
<table cellspacing="0" cellpadding="5" border="0" rules="none" width="100%">
<tbody>
<tr valign="top">
<td width ="20%"><b>Introduction</b></td>
<td width ="80%">
This programming assignment is designed to ensure that you know how to write
  functions that combine the standard control structures in Python:
  <b>block</b>s, <b>if</b>s, <b>for</b> loops, <b>while</b> loops, <b>break</b>,
  <b>try/except</b>, <b>return</b>, and <b>raise</b> statements.
You will also continue gaining experience with the more basic Python features:
  assignment and import statements and expressions (that use arithmetic,
  relational, logical, and textual operators -including lots of
  logical/<b>bool</b> expressions).
<p>
In the first part of the assignment, you will write a variety of generally
  useful functions in the <b>miscfunclib.py</b> module; in the second part you
  will write functions in the <b>tennis.py</b> script, specific to a simulation
  for tennis.
<p>
Import whatever modules/functions you think appropriate, using whatever form
  of import you think appropriate (try to use both forms appropriately).
Use short (but not overly short) well-chosen names.
For indefinite loops, please write <b>while True:</b> loops with
  <b>if</b>/<b>break</b> statements in their blocks; when you are finished,
  you may transform the <b>while</b> test (from <b>True</b> to a real test)
  <b>if the result is simpler</b>.
<p>
You will download the <a href="program4.zip">program4</a> project folder, unzip
  it, move it to your workspace, create a project from it, and write the two
  required modules in this project folder.
Submit each module separately in Checkmate.
<b>Only one student should submit all parts of the the assignment</b>, but both
  student's names should appear in the comments at the top of
  <b>each submitted .py</b> file.
It should look something like
<pre><b>
# Romeo Montague, Lab 1
# Juliet Capulet, Lab 1
# We certify that we worked cooperatively on this programming
#   assignment, according to the rules for pair programming</b></pre>
Please turn in each script <b>as you finish it</b>, so that I can accurately
  assess the progress of the class as a whole during this assignment.
<p>
Print this document and carefully read it, marking any parts that contain
  important detailed information that you find (for review before you turn in
  the files).
Reread the section on <b>Time Management</b> from Programming
  Assignment 0 before starting this assignment.
</td>
</tbody>
</table>



<!-- General Functions -->

<a name="GeneralFunctions">
<hr align="left" width="33%">
<table cellspacing="0" cellpadding="5" border="0" rules="none" width="100%">
<tbody>
<tr valign="top">
<td width ="20%"><b>A Module of General Functions</b></td>
<td width ="80%">
Write a module named <b>miscfunclib</b> that mirrors the library  modules in
   the <b>courselib</b> folder: it contains the following functions, each of
   which might be useful in a variety of scripts.
Note that the <b>miscfunlib</b> module itself contains some code to 
  test these functions
The module <b>miscfunlibdriver</b> (in the downloaded project folder) contains
  a special script that you can use to test your functions more generally.
Test/debug each function after you write it.
<ul>
<li><b>majority</b> defines three <b>bool</b> parameters; it returns whichever
         <b>bool</b> argument value occurs the most times.
    For example, <b>majority(True,False,True)</b> should return <b>True</b>;
    <b>majority(True,False,False)</b> should return </b>False</b>.
    Hint: I found it useful to use arithmetic operators on these parameters:
      recall <b>bool</b> values are promoted to <b>int</b> values: <b>False</b>
      is promoted to <b>0</b> and <b>True</b> is promoted to <b>1</b>.
    My function has 2 lines.
<p>
<li><b>constrain</b> defines three numeric (<b>int</b> or <b>float</b>)
       parameters (name them <b>low</b>, <b>x</b>, and <b>high</b>); it
       raises the <b>ValueError</b> exception if <b>low</b> exceeds
       <b>high</b>, including an appropriate error message with the function
       name, a statement of the error, and the incorrect values of <b>low</b>
        and <b>high</b>.
    Otherwise, it returns <b>x</b>'s value if it is in the range
       <b>[low,high]</b>; if it is outside the range it returns either
       <b>low</b> or <b>high</b>,whichever is closer to <b>x</b>.
    For example, <b>constrain(0,5,10)</b> should return <b>5</b>;
       <b>constrain(0,12,10)</b> should return <b>10</b>;
       <b>constrain(0,-1,10)</b> should return <b>0</b>.
    My function has 9 lines.
<p>
<li><b>prime_density</b> defines two <b>int</b> parameters (name them <b>low</b>
       and <b>high</b>); it returns the ratio of the number of primes between
       these values (inclusive) divided by the number of values in the range.
    Unlike <b>constrain</b> if <b>low</b> exceeeds <b>high</b> in this
       function, swap these two values so <b>low<</b> is the lowests and
       <b>high</b> is the highest</b>.
    For example, <b>prime_density(2,20)</b> should return
      <b>0.42105263157894735</b> (</b>8/19</b>: there are 
      eight primes in this range -2, 3, 5, 7, 11, 13, 17, 19- and 19 values).
    Note that <b>prime_density(2,20)</b> returns the same result as
      <b>prime_density(20,2)</b>.
      <b>prime_density(100,199)</b> should return </b>0.21</b> and 
      <b>prime_density(1000,1199)</b> should return </b>0.14</b> and 

    My function has 10 lines.
<p>
<li><b>nth_prime_after</b> defines two <b>int</b> parameters (name them <b>v</b>
       and <b>n</b>); it returns the <b>n</b>th prime found after <b>v</b>
       (not including <b>v</b>).
    For example <b>nth_prime_after(17,4)</b> should return <b>31</b>
       (<b>19</b> is the first after, <b>23</b> is the second after, 
        <b>29</b> is the third after, and <b>31</b> is the fourth after),
       and <b>nth_prime_after(2,20)</b> should return <b>73</b>.
    Hint: included a defininte loop with an indefinite loop inside.
    First write a function that ignores <b>n</b> and uses and indefinite loop
      to compute the first prime coming after <b>v</b>; then put that code in
      the body of a definite loop that executes its body <b>n</b> times.
    My function has 7 lines.
<p>
<li><b>count_lines</b> defines one <b>str</b> parameter (name it
       <b>file_name</b>); it returns the  number of non-blank lines in the
       specified file.
     If Python cannot find a file with that name, return <b>0</b>.
     Hint: use a <b>try</b>/<b>except</b> statement.
     My function has 8 lines.
<p>
<li><b>Extra Credit: justify</b> defines two parameters, one <b>str</b> and one
        <b>int</b>
       (name them <b>s</b> and <b>n</b>); it returns a string that has all
       the words in <b>s</b> but justified so that every line has no more than
       <b>n</b> characters.
    For example, the <b>miscfunclibdriver.py</b> module contains the name
       <b>ny_story</b> bound to a long string.
    If we execute <b>print(justify(ny_story,40))</b> it prints
<b><pre>         1         2         3         4
1234567890123456789012345678901234567890
John and Mary decided to take a walk in
the park one day. Living in NY, of
course the park was central park, so off
they went. It was a fine spring day so
they saw many fellow New Yorkers on
their trip.</pre></b>
    If we execute <b>print(justify(ny_story,20))</b> it prints
<b><pre>         1         2
12345678901234567890
John and Mary
decided to take a
walk in the park one
day. Living in NY,
of course the park
was central park, so
off they went. It
was a fine spring
day so they saw many
fellow New Yorkers
on their trip.</pre></b>
    Hint: use 3 local names: <b>answer</b>, <b>start</b>, and <b>stop</b>;
           use a double-nested <b>while</b> loop: the outer one determines if
           there are any more words in <b>s</b> to justify; the inner one
           determines the end of the next line to catenate into <b>answer</b>
           (remember to catenate a <b>'\n'</b> at the end of each line).
         Use lots of string indexing and some slicing.
    My function has 11 lines.
</ul>
<h3>Testing</h3>
There are two ways to test these functions.
<ol>
<li>The <b>miscfunclib.py</b> module itself includes the standard tests.examples
      whoen here.
    Recall, the code in the <b>if</b> is execute if we run this module as a
      script (not it it is imported by another module); call to <b>pe</b>
      prints the string (representing an expression) and then the evaluation of
      the string.
<p>
<li>The <b>miscfunclibdriver.py</b> module includes a loop that prompts/executes
      statements executed by the user.
    It imports all the function names from the <b>miscfunlib.py</b> module
      (and because this module is imported, its own tests don't run).
    There are two special functions that the user can call: each expects the
      name of a file that is in the project folder.
    <ul>
    <li><b>batch_test('miscfunclibtest.txt')</b> executes every command in the
          file <b>miscfunlibtest.txt</b>, which I have set up to duplicate the
          tests done in <b>miscfunlib.py</b>.
    <p>
    <li><b>batch_self_check('miscfunclibselfcheck.txt')</b> evaluates every
          expression that comes before <b>-></b> and verifies that it produces
          the result that comes after the <b>-></b>.
        Again, I have set up this file to duplicate the tests done in
           <b>miscfunlib.py</b>.
    </ul>
    Note that if <b>confirm</b> is bound to <b>True</b> these functions wait
      for the user to confirm the proecssing of each line in the file.
    You can useboth of these modules for testing, adding appropriate tests
       to the <b>.txt</b> files.
</ol>
<p>
</tbody>
</table>


<!-- Tennis Simulation -->

<a name="Tennis">
<hr align="left" width="33%">
<table cellspacing="0" cellpadding="5" border="0" rules="none" width="100%">
<tbody>
<tr valign="top">
<td width ="20%"><b>Tennis</b></td>
<td width ="80%">
Write a script that defines various functions that simulate different aspects
  of Tennis: points, games, sets, and matches; these functions will build on
  top of each other: e.g., the points function will help simulate games, the
   games function will help simulate sets, and the sets function will help
   simulate matches.
<p>
Our goal is to investiate the following issue:
Given the probability for which player A beats player B on a
  <b>single point</b>, what is the probability that player A
  <b>wins a match</b> from player B, using the standard rules (scoring) for
  tennis?
<p>
For example, if the probability that player A beats player B on a single point
  is 50%, we would expect each player to win about 50% of the matches.
How much better, per point, would player A have to be over player B, for player
  A to win win 90% of the matches?
Would he/she have to be a bit better (win a single point with probability 51%)
  or have to be a lot better (win a single point with probability 90%)?
Generally, what is the relationship between the probability of winning a single
   point and the probability of winning an entire match (composed of sets,
  composed of games, composed of points)?
<p>
Once we have investigated this issue, we can also investigate the same question
  for different rules in tennis: by changing our functions/script we can
  easily investigate changes like adjusting
<ul>
<li>the minium number of points to win a game, games to win a set, or sets to
      win a match.
<p>
<li>the number of points/games/sets needed to be ahead (always 2 in tennis) to
      win a game/set/match.
</ul>
All these rule changes would require us to change the simulation in a minor
  way (by changing some numbers in our script); for radically different rules,
  we would have to revise the Python code in our functions/script more
  extensively.
<p>
Here are a summary of the rules of tennis: how to win games, sets, and matches
  (which are actually all similar).
<ul>
<li> Games consisist of points won by each player: to win a game, a player must
        have won at least 4 points, and have won at least 2 more points than the
        other player.
<p>
<li> Sets consisist of games won by each player: to win a set, a player must
        have won at least 6 games, and have won at least 2 more games than the
        other player.
<p>
<li> Matches consisist of sets won by each player: to win a match, a player must
        have won at least 3 sets, and have won at least 2 more sets than the
        other player.
</ul>
Write your functions/script in the <b>tennis.py</b> module.
<ol>
<li>Write a <b>for</b> loop using <b>frange</b> function, already written in
      the <b>tennis.py</b> module.
      It should print all the values from <b>.45</b> to <b>.55</b> inclusive, in
        step of <b>.01</b>.
      Some of these numbers may print a bit funny (don't worry about that now).
      Put this code in a comment and leave it at the bottom of the
        <b>tennis.py</b> module (writing the code specified below in between).
<p>
  <li>Define the function <b>point_winner</b> with the header
    <b><pre>point_winner(percent_A_win_point)</pre></b>
  This function returns either <b>'A'</b> or <b>'B'</b> as the winner of one
    point in a tennis game, given that <b>percent_A_win_point</b>'s argument
    will be a <b>float</b> in the range <b>[0.0,1.0]</b> where <b>0.0</b> means
    A wins 0% of the points (never) and <b>1.0</b> means  A wins 100% of the
    points (always); if <b>percent_A_win_point</b> is <b>.50</b> it means A
    wins 50% of the points (half).
  <p>
  To simulate a point, we will use the <b>rand</b> function in the <b>random</b>
    module.
  Its header is <b>random.random() -> float:</b> (yes, a parameterless
    function).
  When called, it returns a random <b>float</b> in the range <b>[0.0,1.0]</b>
    inclusive, such that each value in this range is equally likely.
  So <b>random.random</b> is parametrless because it always returns a result
     in the same range.
  <p>
  This function should return <b>'A'</b> if the random number is <b>&lt=</b>
    <b>percent_A_win_point</b>, and <b>'B'</b> otherwise.
  For example, if <b>percent_A_win_point</b> is <b>.75</b>, it means that 75% of
    the random numbers generated will have a value <b>&lt=</b>
    <b>percent_A_win_point</b>, so this function will return <b>'A'</b> 75% of
    the time.
<p>
<li>Define the function <b>A_win_stats</b> with the header
   <pre><b>A_win_stats(percent_A_win_point, times_to_play, trace=False)</b></pre>
  Primarily this function calls the <b>point_winner</b> function
    <b>times_to_play</b> times and returns the percentage of points that A wins.
  If <b>trace</b> is <b>True</b> it also prints out the details of each point.
  So, if we executed the following script after defining the function
<b><pre>result = A_win_stats(.50, 10, True)
print('A won',str(result)+'%')</pre></b>
The console might contain (might, because random number are invovled) the
  following trace and final print.
<pre>Playing 10 points with percent_A_win_point = 0.50
  point 1 winner = B
  point 2 winner = B
  point 3 winner = A
  point 4 winner = B
  point 5 winner = B
  point 6 winner = A
  point 7 winner = A
  point 8 winner = A
  point 9 winner = A
  point 10 winner = A
A won 60.0 percent of the points
A won 60.0%</pre></b>
Notice that all lines but the last are printed by the <b>A_win_stats</b>
  function; the last is printed by the second statement above.
If instead our script specified <b>trace=False</b>, it would print only
<b><pre>A won 60.0%</pre></b>
So admittedly this function is strange because it primarily computes a value,
  but optionally it outputs information to the console, tracing its actions.
<p>
Define the function <b>A_win_stats</b> and use the script above to test it with
  different perecentages for A winning, both with tracing on and off.
With tracing off, play thousands or millions of points and observe that the
  percentage of time A wins is very close to the argument passed to the first
  parameter of <b>A_win_stats</b>.
Hint: my function is 13 lines long
<p>
<li>Define the function <b>game_winner</b> with the header
    <pre><b>game_winner(percent_A_win_point)</b></pre>
  This function simulates a full game of tennis by calling <b>point_winner</b>
    repeatedly, until one player wins (according to the rules of tennis above):
    the function returns <b>'A'</b> or <b>'B'</b>.
  Hint: keep track of the number or points won by each player; write an
    indefinite loop that terminates when one play has won the game according to
    the rules; return the letter for that player.
  While debugging this function you might print the winner of each point,
    to see that the function is following the scoring rules correctly; later
    you can comment-out this printing.
  My function is 12 lines long.
<p>
<li>Make a copy of your original <b>A_win_stats</b> function and comment out
      one version.
    Modify the uncommented-out version so that it calls <b>game_winner</b> and
      for the following script
<b><pre>result = A_win_stats(.50, 10, trace=True)
print('A won',str(result)+'%')</pre></b>
produces the following output on the console.
Notice that some of the words have changed.
<pre>Playing 10 games with percent_A_win_point = 0.5
  game 1 winner = B
  game 2 winner = A
  game 3 winner = B
  game 4 winner = B
  game 5 winner = A
  game 6 winner = B
  game 7 winner = B
  game 8 winner = A
  game 9 winner = B
  game 10 winner = A
A won 40.0 percent of the games
A won 40.0%</pre></b>
<p>
<li>Rewrite the function <b>A_win_stats</b> so that it can be used to call
       either the <b>point_winner</b> or <b>game_winner</b> function and
       print the right information <b>point</b>/<b>points</b> or
       <b>game</b>/<b>games</b>.
    Generalize it header to 
   <pre><b>A_win_stats(percent_A_win_point, play_function, times_to_play, trace=False, unit=None, suffix='s')</b></pre>
Doing so allows us to call <b>A_win_stats</b> in many different ways:
<b><pre>result = A_win_stats(.50, point__winner, 10, True, 'point','s')
result = A_win_stats(.50, game_winner, 10, True, 'game')
result = A_win_stats(.50, game_winner, 1000)</pre></b>
The first calls the <b>point_winner</b> function <b>10</b> times with tracing,
  printing <b>point</b>/<b>points</b>.
The second calls the <b>game_winner</b> function <b>10</b> times with tracing,
  printing <b>game</b>/<b>games</b> (with <b>suffix</b> binding to its default
  argument <b>'s'</b>).
The third calls the <b>game_winner</b> function <b>1000</b> times with no
  tracing: the last three parameters bind to their default values, and because
  <b>tracing</b> binds to <b>False</b> the other two parameters are never used.
<p>
After rewriting your <b>A_win_stats</b> function, ensure each of these three
  function calls works as described above.
<p>
<li>Define the function <b>set_winner</b> with the header
    <pre><b>set_winner(percent_A_win_point)</b></pre>
  This function simulates a full set of tennis by calling <b>game_winner</b>
    repeatedly, until one player wins (according to the rules of tennis above):
    the function returns <b>'A'</b> or <b>'B'</b>.
  Hint: <b>set_winner</b> and <b>game_winner</b> have identical structure; it
    should be simple to copy/paste <b>game_winner</b> and then modify it to
   define <b>set_winner</b>.
<p>
Write a script to call <b>A_win_stats</b> and play 10 sets with tracing on,
  and then play 1,000 sets with tracing off.
<p>
<li>Define the function <b>match_winner</b> with the header
    <pre><b>match_winner(percent_A_win_point)</b></pre>
  This function simulates a full set of tennis by calling <b>set_winner</b>
    repeatedly, until one player wins (according to the rules of tennis above):
    the function returns <b>'A'</b> or <b>'B'</b>.
  Hint: <b>match_winner</b> and <b>set_winner</b> and <b>game_winner</b> have
    identical structure; it should be simple to copy/paste one of these
    functions and then modify it to define <b>match_winner</b>
<p>
Write a script to call <b>A_win_stats</b> and play 10 matches with tracing on,
  and then play 1,000 matches with tracing off.
<p>
<li>Write a script at the bottom of this module that prompts the user for
      a range of winning percentages for player A (a minimum, maximum, and
      step) and the number of matches to play, and computes and tabulates the
      results showing how the differences in the percentage of winning a point,
      compound to produce the differences in the percentages of winning a match.
<p>
</ol>
Here is an example of my final script running.
I supplied default values to the prompting functions (they automatically appear
  in brackets) and just pressed enter to use those default values when prompted.
Of course because we are using random numbers, your answer may be different.
What is surprising is how senstiive winning matches is to winning points: a
  slightly better percentage for winning points translates into a much lareger
  percentage for winning matches.
<b><pre>Enter minimum percentage[0.45]: 
Enter maximum percentage[0.55]: 
Enter percentage step[0.01]: 
Enter matches to play[10000]: 
with percent_A_win_point = 45.0% A wins  2.3% of the matches
with percent_A_win_point = 46.0% A wins  5.7% of the matches
with percent_A_win_point = 47.0% A wins 10.9% of the matches
with percent_A_win_point = 48.0% A wins 20.2% of the matches
with percent_A_win_point = 49.0% A wins 33.9% of the matches
with percent_A_win_point = 50.0% A wins 50.1% of the matches
with percent_A_win_point = 51.0% A wins 65.8% of the matches
with percent_A_win_point = 52.0% A wins 79.2% of the matches
with percent_A_win_point = 53.0% A wins 88.7% of the matches
with percent_A_win_point = 54.0% A wins 94.2% of the matches
with percent_A_win_point = 55.0% A wins 97.3% of the matches</pre></b>
An upcoming lecture (before the project is dues) will cover printing
  <b>float</b> values nicely.
</td>
</tbody>
</table>





</body>
</html>

