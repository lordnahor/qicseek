<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta content="text/html; charset=windows-1252"
      http-equiv="Content-Type">
    <title>Lab 3: Probability Distributions in R</title>
    <meta content="Stacey Hancock" name="author">
  </head>
  <body>
    <table style="width: 100%; background-color: rgb(102, 204, 204);
      margin-left: auto; margin-right: auto; height: 58px; text-align:
      left;" border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td>
            <div style="text-align: center;"> </div>
            <h1 style=" text-align: center;">Lab 3: Probability
              Distributions in R<br>
            </h1>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    R has four functions for each distribution, beginning with a "d",
    "p", "q", or "r" and followed by the name of the distribution. For
    example, for a binomial distribution with 10 trials and success
    probability 1/3,<br>
    <pre># d = "Density" function: <br># For a discrete random variable, this is its probability mass function (pmf), e.g., the probability X = 5.<br># For a continuous random variable, this gives the value of its probability density function (pdf).<br>dbinom(5,10,1/3)<br><br># p = Cumulative distribution function (cdf): e.g., the probability X &lt;= 5.<br>pbinom(5,10,1/3)<br><br># q = Quantile function: The value of X such that, e.g., .25 proportion of the<br>#   distribution lies below it, i.e., the inverse of the cdf.<br>qbinom(.25,10,1/3)<br><br># r = Random generation: e.g., generate 20 data points from the distribution.<br>rbinom(20,10,1/3)</pre>
    <br>
    The two main types of random variables are <span
      style="font-weight: bold;">discrete</span> and <span
      style="font-weight: bold;">continuous</span>. A random variable is
    <span style="text-decoration: underline;">discrete</span> if you can
    enumerate all possible values of the variable. The R functions for
    several discrete distributions are:<br>
    <br>
    <table style="text-align: left; width: 100%; background-color:
      rgb(255, 204, 51);" border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">Discrete
            Distribution<br>
            (parameters)<br>
          </td>
          <td style="vertical-align: top; font-weight: bold;">Scenario<br>
          </td>
          <td style="vertical-align: top; font-weight: bold;">Possible
            Values<br>
          </td>
          <td style="vertical-align: top; font-weight: bold;">R Function<br>
            (_ = d, p, q, r)<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X ~ Binomial(n, p)<br>
          </td>
          <td style="vertical-align: top;">X = number of "successes" in
            n independent trials;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P("success") = p<br>
            <br>
          </td>
          <td style="vertical-align: top;">0, 1,..., n<br>
          </td>
          <td style="vertical-align: top;">
            <pre>_binom</pre>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X ~ Poisson(lambda)<br>
          </td>
          <td style="vertical-align: top;">X = count of "rare" events in
            an interval of time; <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mean count = lambda<br>
          </td>
          <td style="vertical-align: top;">0, 1, 2,...<br>
          </td>
          <td style="vertical-align: top;">
            <pre>_pois</pre>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X ~ Geometric(p)<br>
          </td>
          <td style="vertical-align: top;">X = number of "failures"
            until first "success"; <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P("success") = p<br>
          </td>
          <td style="vertical-align: top;">0, 1, 2,...<br>
          </td>
          <td style="vertical-align: top;">
            <pre>_geom</pre>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X ~ Negative Binomial(r, p)<br>
          </td>
          <td style="vertical-align: top;">X = number of "failures"
            until rth "success";<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P("success") = p</td>
          <td style="vertical-align: top;">0, 1, 2,...<br>
          </td>
          <td style="vertical-align: top;">
            <pre>_nbinom</pre>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X ~ Hypergeometric(N, k, n)<br>
          </td>
          <td style="vertical-align: top;">X = number of "successes" in
            a sample of size n from <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; an population of N
            items, k of which are "successes" <br>
            &nbsp; &nbsp; &nbsp; &nbsp;and N-k are "failures"<br>
          </td>
          <td style="vertical-align: top;">max(0, n-(N-k)),...,<br>
            min(n, k)<br>
          </td>
          <td style="vertical-align: top;">
            <pre>_hyper</pre>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    A random variable is <span style="text-decoration: underline;">continuous</span>
    if it can take any value in an interval of the real line. The R
    functions for several continuous distributions are:<br>
    <br>
    <table style="text-align: left; width: 100%; background-color:
      rgb(255, 204, 51);" border="1" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td style="vertical-align: top; font-weight: bold;">Continuous
            Distribution<br>
            (parameters)<br>
          </td>
          <td style="vertical-align: top; font-weight: bold;">Scenario<br>
          </td>
          <td style="vertical-align: top; font-weight: bold;">Possible
            Values<br>
          </td>
          <td style="vertical-align: top; font-weight: bold;">R Function<br>
            (_ = d, p, q, r)<br>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X ~ Normal(mean, sd)<br>
          </td>
          <td style="vertical-align: top;">"bell curve"<br>
            e.g., approximate distribution of people's heights<br>
          </td>
          <td style="vertical-align: top;">(-infinity, infinity)<br>
          </td>
          <td style="vertical-align: top;">
            <pre>_norm</pre>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X ~ Uniform(min, max)<br>
          </td>
          <td style="vertical-align: top;">X = random number chosen from
            the interval [min, max]<br>
          </td>
          <td style="vertical-align: top;">[min, max]<br>
          </td>
          <td style="vertical-align: top;">
            <pre>_unif</pre>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X ~ Exponential(rate)<br>
          </td>
          <td style="vertical-align: top;">X = time between events with
            given rate<br>
          </td>
          <td style="vertical-align: top;">[0, infinity)<br>
          </td>
          <td style="vertical-align: top;">
            <pre>_exp</pre>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X ~ Lognormal(meanlog, sdlog)<br>
          </td>
          <td style="vertical-align: top;">X = exp(Normal random
            variable with mean and sd),<br>
            i.e., log(X) ~ Normal(log(meanlog), log(sdlog))<br>
            e.g., approximate distribution of people's income<br>
          </td>
          <td style="vertical-align: top;">[0, infinity)</td>
          <td style="vertical-align: top;">
            <pre>_lnorm</pre>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X ~ Gamma(alpha, beta)</td>
          <td style="vertical-align: top;">Varies; Exponential is a
            special case of Gamma<br>
          </td>
          <td style="vertical-align: top;">[0, infinity)</td>
          <td style="vertical-align: top;">
            <pre>_gamma</pre>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X ~ Beta(alpha, beta)</td>
          <td style="vertical-align: top;">Varies; Uniform is a special
            case of Beta</td>
          <td style="vertical-align: top;">[0, 1]</td>
          <td style="vertical-align: top;">
            <pre>_beta</pre>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X ~ Chi-squared(df)<br>
          </td>
          <td style="vertical-align: top;">Will come up in hypothesis
            testing.<br>
          </td>
          <td style="vertical-align: top;">[0, infinity)<br>
          </td>
          <td style="vertical-align: top;">
            <pre>_chisq</pre>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X ~ t(df)<br>
          </td>
          <td style="vertical-align: top;">Will come up in hypothesis
            testing. </td>
          <td style="vertical-align: top;">(-infinity, infinity) </td>
          <td style="vertical-align: top;">
            <pre>_t</pre>
          </td>
        </tr>
        <tr>
          <td style="vertical-align: top;">X ~ F(df1, df2)<br>
          </td>
          <td style="vertical-align: top;">Will come up in hypothesis
            testing.</td>
          <td style="vertical-align: top;">[0, infinity)</td>
          <td style="vertical-align: top;">
            <pre>_f</pre>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <br>
    <big><span style="font-weight: bold;">It's a good idea to become
        familiar with the syntax of the R functions for each
        distribution (some of the arguments aren't what you would
        expect). Try looking up the help files for several of these
        functions.<br>
        <br>
      </span></big>
    <hr style="width: 100%; height: 2px;">
    <h2><big><span style="font-weight: bold;"></span></big></h2>
    <h2>Examples Using the Binomial Distribution</h2>
    <meta http-equiv="content-type" content="text/html;
      charset=windows-1252">
    <h3 style="text-align: center;"> dbinom Examples</h3>
    <p>For a Binomial(6,1/3) random variable named <span
        style="font-style: italic;">X</span>, compute the probability of
      2 successes, Pr(X=2): </p>
    <pre>&gt; dbinom(2,6,1/3)
[1] 0.3292181
</pre>
    Compare to the direct computation:
    <pre>Pr(X = 2) = ((6*5*4*3*2*1)/(2*1*4*3*2*1))*(1/3)^2*(2/3)^4 

          = 15*(1/3)^2*(2/3)^4

          =  0.3292181
</pre>
    or
    <pre>         choose(6,2)*(1/3)^2*(2/3)^4
</pre>
    <p> We can compute the probabilities for the whole sample space at
      once if we like with: </p>
    <pre>          dbinom(0:6,6,1/3)
</pre>
    A nicer way to display those probabilities is in a table:
    <pre>          matrix(c(0:6,dbinom(0:6,6,1/3)),ncol=2,
                 dimnames=list(NULL,c("n","Prob")))
</pre>
    When printing tables like this, it is often better to round off the
    entries to fewer significant digits:
    <pre>          M &lt;- matrix(c(0:6,dbinom(0:6,6,1/3)),ncol=2,
                      dimnames=list(NULL,c("n","Prob")))
          round(M,4)
</pre>
    <p> We can also produce the theoretical histogram for repeated
      trials of a given binomial experiment. Here is a function to draw
      the binomial density "curve", you can paste it in to your R
      session: </p>
    <pre>hist.binom &lt;- function(n, p, ...)
{
# plots a relative frequency histogram of the binomial distribution
        k &lt;- 0:n
        p &lt;- dbinom(k, n, p)
        names(p) &lt;- as.character(0:n)
        barplot(p,space=0, ...)
}
</pre>
    A relative frequency histogram is just a barplot with no space
    between the bars, where the total area is 1. The height of each bar
    here the probability associated with that binomial outcome. To use
    the hist.binom function defined above, you must specify the values
    of n and p. For example, to get the histogram of a Binomial(6,1/3)
    distribution, use
    <pre>  
       hist.binom(6,1/3)
</pre>
    Try experimenting with the color ("col") argument; use <span
      style="font-family: monospace;">help(colors)</span> or <span
      style="font-family: monospace;">colors()</span> to see what colors
    R knows by name.
    <pre>  
       hist.binom(6,1/3,col="yellow")
</pre>
    <h3 style="text-align: center;">pbinom Examples</h3>
    <meta http-equiv="content-type" content="text/html;
      charset=windows-1252">
    <p> For a binomial(6,1/3) random variable X, compute the probability
      that X is less than 3; in other words, Pr(X &lt;= 2): </p>
    <pre>          pbinom(2,6,1/3)
</pre>
    Compare to summing the density (ie adding up the areas under the
    binomial histogram:
    <pre>          dbinom(0,6,1/3)+dbinom(1,6,1/3)+dbinom(2,6,1/3)

or

          sum(dbinom(0:2,6,1/3))
</pre>
    <p> We can find the probability that we get more than a given number
      of successes by subtraction: for the probability that X is greater
      than 2, Pr(X &gt; 2): </p>
    <pre>          1 - pbinom(2,6,1/3)
</pre>
    We could of course compute the probability of that event by summing
    the individual probabilities:
    <pre>          sum(dbinom(3:6,6,1/3))
</pre>
    Finally, R has another option for this computation:
    <pre>          pbinom(2,6,1/3,lower.tail=FALSE)
</pre>
    The tails of a probability distribution are the values at either end
    of the range of the random variable. The pbinom function normally
    assumes that you want the lower tail of the distribution, that is
    the probability of getting less than or equal to a specified value.
    The specification "lower.tail=FALSE" tells S to compute the upper
    tail of the distribution, that is the probability of getting a value
    greater than the argument. Compare all three methods and make sure
    that they give the same probabilities. <b> Note:</b> since the
    Binomial sample space only includes integer values, Pr(X &lt; k) is
    the same as Pr(X &lt;= k-1). <br>
    <h3 style="text-align: center;">qbinom Examples</h3>
    <meta http-equiv="content-type" content="text/html;
      charset=windows-1252">
    <p> For continuous distributions, the "p" function and the "q"
      function are inverses (i.e., either one undoes the action of the
      other: try&nbsp;<span style="font-family: monospace;">
        qnorm(pnorm(0))&nbsp;</span> or&nbsp; <span style="font-family:
        monospace;">pnorm(qnorm(.5))</span>.) This doesn't work out
      quite so perfectly for the binomial distribution because of the
      discrete nature of the sample space. It is too "lumpy." Compare<br>
    </p>
    <pre>      qbinom(.5,6,1/3)

      pbinom(2,6,1/3)
<br></pre>
    Recall that our textbook defines the quantile function in Definition
    3.3.2 on p. 112. The <i>q</i>-quantile is equivalent to the 100<i>q</i>-percentile.
    For example, the 75th percentile is the .75 quantile.<br>
    <br>
    <hr size="2" width="100%">
    <meta http-equiv="content-type" content="text/html;
      charset=windows-1252">
    <h2>The Normal Distribution<br>
    </h2>
    By far, the most popular continuous distribution is the normal
    distribution. Type the command below to plot the density function of
    a standard normal distribution:<br>
    <pre>curve(dnorm(x),-3,3)<br></pre>
    Many variables approximately follow a normal distribution, for
    example, the heights of adults, or IQ scores, basically, any
    variable that tends to cluster around its mean. It is defined by two
    parameters, its mean and its standard deviation. The <span
      style="font-weight: bold;">standard normal distribution </span>has

    mean zero and standard deviation 1.<br>
    <br>
    For any random variable X with a normal distribution having mean <span
      style="font-style: italic;">m</span> and standard deviation <span
      style="font-style: italic;">s</span>, the <span
      style="font-weight: bold;">z-score</span> of a value <span
      style="font-style: italic;">x </span>of X is defined as:<br>
    <br>
    <span style="font-style: italic;">z</span> = (<span
      style="font-style: italic;">x - m)/s</span><br>
    <br>
    The random variable Z = (X - <span style="font-style: italic;">m</span>)/<span
      style="font-style: italic;">s</span> has mean zero and standard
    deviation one, i.e., it has been centered (subtract mean) and scaled
    to standard deviation one (divide by standard deviation). Since X =
    <span style="font-style: italic;">s</span>Z + <span
      style="font-style: italic;">m</span>, one can think of the z-score
    <span style="text-decoration: underline;">the number of standard
      deviations away from the mean</span>. The probabilities of being
    within one, two, or three standard deviations from the mean are
    shown below:<br>
    <br>
    <img style="width: 497px; height: 291px;" alt="Standard Normal
      Distribution Probabilities" src="stdnormaldist.jpg" width="497"
      height="291"><br>
    <br>
    Let's check this in R (by default, "_norm" functions use mean = 0
    and sd = 1 - look at the help menu):<br>
    <pre>pnorm(1)-pnorm(-1)<br>pnorm(2)-pnorm(-2)<br>pnorm(3)-pnorm(-3)<br></pre>
    If we were interested in a normal random variable X with mean 5 and
    standard deviation 2, we could calculate the same probabilities by:<br>
    <pre>pnorm(5+2,5,2)-pnorm(5-2,5,2)<br>pnorm(5+2*2,5,2)-pnorm(5-2*2,5,2)<br>pnorm(5+3*2,5,2)-pnorm(5-3*2,5,2)<br></pre>
    The <span style="font-weight: bold;"><span style="font-style:
        italic;">p</span>th percentile</span> is defined to be the value
    for which <span style="font-style: italic;">p</span> percent of the
    distribution lies below it. For example, the values -3, -2, -1, 0,
    1, 2, and 3 of a standard normal distribution correspond to the
    following percentiles:<br>
    <pre>round(pnorm(-3:3),3)*100<br></pre>
    The "qnorm" function is used to find percentiles (the "q" stands for
    "quantile," a general term for percentile). Thus, for example, two
    standard deviations below the mean corresponds to the "2.3rd
    percentile":<br>
    <pre>qnorm(.023)<br></pre>
    Or without rounding error,<br>
    <pre>qnorm(pnorm(-2))<br></pre>
    <br>
    <hr style="width: 100%; height: 2px;">
    <div style="text-align: center;"><big><span style="font-weight:
          bold;">Next:</span> <a href="Graphics.html">Graphics in R</a><br>
        <br>
        <a href="index.html">Lab 3 Index</a></big><br>
      <hr style="width: 100%; height: 2px;"><br>
    </div>
  </body>
</html>

